
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>
    
  JUC - 
  

  </title>
  <meta name="author" content="">
  <meta name="description" content="">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href="asset/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="atom.xml" rel="alternate" title="" type="application/atom+xml">
  <script src="asset/js/modernizr-2.0.js"></script>
  <script src="asset/js/jquery.min.js"></script>
  <style type="text/css">
  .cat-children-p{ padding: 6px 0px;}
  .hljs{background: none;}
  </style>
  <script type="text/javascript">
  var isAddSildbar = true;
  </script>
  <script src="asset/js/octopress.js" type="text/javascript"></script>
</head>
<script type="text/javascript">
//é“¾æ¥æ–°å¼€çª—å£
function addBlankTargetForLinks () {
  $('a[href^="http"]').each(function(){
      $(this).attr('target', '_blank');
  });
}
$(document).ready(function(event) {
  addBlankTargetForLinks();
});
</script>
<body   >
  <header role="banner"><hgroup>
  <h1><a href="index.html"></a></h1>
  
    <h2></h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">

  <li id=""><a target="_self" href="index.html">Home</a></li>

  <li id=""><a target="_self" href="archives.html">Archives</a></li>

</ul>

</nav>
  <div id="main">
    <div id="content"> 
<div class="blog-index">

	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16247740620828.html">AQS</a></h1>
			<p class="meta"><time datetime="2021-06-27T14:07:42+08:00" 
			pubdate data-updated="true">2021/06/27</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#%E5%8E%9F%E7%90%86">åŸç†</a>
<ul>
<li><a href="#%E5%85%B1%E4%BA%AB%E6%96%B9%E5%BC%8F">å…±äº«æ–¹å¼</a>
<ul>
<li><a href="#%E7%8B%AC%E5%8D%A0">ç‹¬å </a></li>
<li><a href="#%E5%85%B1%E4%BA%AB">å…±äº«</a></li>
</ul>
</li>
<li><a href="#%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97">ç­‰å¾…é˜Ÿåˆ—</a></li>
<li><a href="#%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E5%90%8C%E6%AD%A5%E5%99%A8%EF%BC%9F">å¦‚ä½•è‡ªå®šä¹‰åŒæ­¥å™¨ï¼Ÿ</a></li>
</ul>
</li>
<li>[å¸¸è§çš„åŒæ­¥å™¨ï¼ˆ<a href="16226447097561.html">è¾…åŠ©ç±»</a>ï¼‰](#å¸¸è§çš„åŒæ­¥å™¨ï¼ˆè¾…åŠ©ç±»16226447097561-htmlï¼‰)
<ul>
<li><a href="#semaphore">Semaphore</a></li>
<li><a href="#countdownlatch">CountDownLatch</a></li>
<li><a href="#cyclicbarrier">CyclicBarrier</a></li>
</ul>
</li>
</ul>
</div>
<p><a href="https://snailclimb.gitee.io/javaguide/#/docs/java/multi-thread/AQS%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8AAQS%E5%90%8C%E6%AD%A5%E7%BB%84%E4%BB%B6%E6%80%BB%E7%BB%93?id=_5-cyclicbarrier%E5%BE%AA%E7%8E%AF%E6%A0%85%E6%A0%8F">å‚è€ƒ</a></p>
<h2><a id="%E5%8E%9F%E7%90%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>åŸç†</h2>
<p>AQSï¼ˆ<code>AbstractQueuedSynchronizer</code>ï¼‰åŒæ­¥å™¨ï¼Œå¯ä»¥åˆ©ç”¨å®ƒåè°ƒçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥è¡Œä¸ºï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€å¥—çº¿ç¨‹é˜»å¡ç­‰å¾…ä»¥åŠè¢«å”¤é†’æ—¶é”åˆ†é…çš„æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶ AQS æ˜¯ç”¨ CLH é˜Ÿåˆ—å®ç°çš„ï¼Œå³å°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚<br />
<img src="media/16247740620828/16247741942725.jpg" alt="" class="mw_img_center" style="width:600px;display: block; clear:both; margin: 0 auto;" /></p>
<p>åŒæ­¥çŠ¶æ€ä½¿ç”¨æˆå‘˜å˜é‡ stateï¼ˆ volatileã€åŸå­æ“ä½œ ï¼‰è¡¨ç¤ºï¼ŒAQS å°±æ˜¯é€šè¿‡å¯¹ state çš„åŸå­æ“ä½œæ¥è¾¾åˆ°åŒæ­¥å„ä¸ªçº¿ç¨‹çš„ç›®çš„ã€‚</p>
<h3><a id="%E5%85%B1%E4%BA%AB%E6%96%B9%E5%BC%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å…±äº«æ–¹å¼</h3>
<h4><a id="%E7%8B%AC%E5%8D%A0" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ç‹¬å </h4>
<p>åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œï¼Œå¦‚ ReentrantLockã€‚åˆåˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”ï¼ŒåŒºåˆ«æœ‰ä¸¤ç‚¹ï¼š</p>
<ol>
<li>éå…¬å¹³é”åœ¨è°ƒç”¨ lock åï¼Œä¼šå…ˆä½¿ç”¨ CAS è¿›è¡Œä¸€æ¬¡æŠ¢é”ï¼ŒæŠ¢ä¸åˆ°å°±è¿›å…¥ <code>tryAcquire()</code> æ–¹æ³•ï¼›å…¬å¹³é”ç›´æ¥è¿›å…¥ <code>tryAcquire()</code></li>
<li>å¦‚æœé”é‡Šæ”¾äº†ï¼Œéå…¬å¹³é”å†æŠ¢ä¸€æ¬¡é”ï¼Œè€Œå…¬å¹³é”è¦åˆ¤æ–­é˜»å¡é˜Ÿåˆ—æœ‰æ²¡æœ‰çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œéå…¬å¹³é”æŠ¢ä¸åˆ°é”æˆ–å…¬å¹³é”æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…å°±è¿›å…¥é˜»å¡é˜Ÿåˆ—ç­‰å¾…å”¤é†’</li>
</ol>
<blockquote>
<p><code>ReentrantLock</code>ï¼Œstate åˆå§‹åŒ–ä¸º 0ï¼Œè¡¨ç¤ºæœªé”å®šçŠ¶æ€ã€‚A çº¿ç¨‹ <code>lock()</code> æ—¶ï¼Œä¼šè°ƒç”¨ <code>tryAcquire()</code> ç‹¬å è¯¥é”å¹¶å°† state+1ã€‚æ­¤åï¼Œå…¶ä»–çº¿ç¨‹å† <code>tryAcquire()</code> æ—¶å°±ä¼šå¤±è´¥ï¼Œç›´åˆ° A çº¿ç¨‹ <code>unlock()</code> åˆ° state=0ï¼ˆå³é‡Šæ”¾é”ï¼‰ä¸ºæ­¢ï¼Œå…¶å®ƒçº¿ç¨‹æ‰æœ‰æœºä¼šè·å–è¯¥é”ã€‚</p>
</blockquote>
<h4><a id="%E5%85%B1%E4%BA%AB" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å…±äº«</h4>
<p>å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ‰§è¡Œï¼Œå¦‚ Semaphoreã€CountDownLatchã€‚</p>
<h3><a id="%E7%AD%89%E5%BE%85%E9%98%9F%E5%88%97" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ç­‰å¾…é˜Ÿåˆ—</h3>
<p>å¦‚æœè·å–é”å¤±è´¥ï¼Œå°±åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</p>
<ol>
<li>é€šè¿‡å½“å‰çº¿ç¨‹å’Œé”æ¨¡å¼æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹</li>
<li>pred æŒ‡é’ˆæŒ‡å‘å°¾èŠ‚ç‚¹ tail</li>
<li>å°†æ–°èŠ‚ç‚¹çš„ prev æŒ‡å‘ pred</li>
<li>é€šè¿‡ compareAndSetTail å®Œæˆå°¾èŠ‚ç‚¹çš„è®¾ç½®</li>
<li>å¦‚æœæ²¡æœ‰åˆå§‹åŒ–å°±æ„é€ ä¸€ä¸ªç©ºçš„å¤´ç»“ç‚¹</li>
</ol>
<h3><a id="%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E5%90%8C%E6%AD%A5%E5%99%A8%EF%BC%9F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å¦‚ä½•è‡ªå®šä¹‰åŒæ­¥å™¨ï¼Ÿ</h3>
<p>AQS çš„è®¾è®¡æ˜¯åŸºäºæ¨¡ç‰ˆæ–¹æ³•çš„ï¼Œç»§æ‰¿ <code>AbstractQueuedSynchronizer</code> å¹¶é‡å†™æŒ‡å®šçš„æ–¹æ³•å³å¯ï¼ˆ<code>tryAcquire / tryRelease</code> æˆ– <code>tryAcquireShared / tryReleaseShared</code>ï¼‰ã€‚</p>
<pre><code class="language-java">isHeldExclusively()//è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ°conditionæ‰éœ€è¦å»å®ç°å®ƒã€‚
tryAcquire(int)//ç‹¬å æ–¹å¼ã€‚å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚
tryRelease(int)//ç‹¬å æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚
tryAcquireShared(int)//å…±äº«æ–¹å¼ã€‚å°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚
tryReleaseShared(int)//å…±äº«æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚
</code></pre>
<h2><a id="%E5%B8%B8%E8%A7%81%E7%9A%84%E5%90%8C%E6%AD%A5%E5%99%A8%EF%BC%88%E8%BE%85%E5%8A%A9%E7%B1%BB16226447097561-html%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å¸¸è§çš„åŒæ­¥å™¨ï¼ˆ<a href="16226447097561.html">è¾…åŠ©ç±»</a>ï¼‰</h2>
<h3><a id="semaphore" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Semaphore</h3>
<p>å¯ä»¥é™åˆ¶è®¿é—®å…±äº«èµ„æºçš„çº¿ç¨‹æ•°é‡ã€‚</p>
<p>åŸç†æ˜¯åˆå§‹åŒ– state ä¸º Nï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œ <code>acquire()</code>ï¼Œå¦‚æœ state &gt; 0ï¼Œå°±ä½¿å¾— state - 1ï¼Œå¦‚æœ state = 0ï¼Œå°±åŠ å…¥é˜»å¡é˜Ÿåˆ—ï¼Œå¹¶è‡ªæ—‹åˆ¤æ–­ state æ˜¯å¦å¤§äº 0ï¼›çº¿ç¨‹è°ƒç”¨ <code>release()</code> ä½¿ state + 1ï¼Œé˜»å¡çš„çº¿ç¨‹ä¼šç«äº‰è¿™ä¸ªé”ã€‚</p>
<h3><a id="countdownlatch" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CountDownLatch</h3>
<p>å¯ä»¥ä½¿å¤šä¸ªçº¿ç¨‹é˜»å¡åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæ¯•ã€‚ï¼ˆç±»ä¼¼å€’è®¡æ—¶çš„æ•ˆæœï¼Œ<strong>ä¸€æ¬¡æ€§çš„</strong>ï¼‰</p>
<p>åŸç†æ˜¯åˆå§‹åŒ– state ä¸º Nï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œ <code>countDown()</code> æ–¹æ³•ä½¿å¾— state - 1ï¼Œè°ƒç”¨ <code>await()</code> ä¼šé˜»å¡å¹¶è‡ªæ—‹åˆ¤æ–­ stateï¼Œå¦‚æœ state = 0ï¼Œå°±é‡Šæ”¾æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œæ‰§è¡Œ <code>await()</code> ä¹‹åçš„è¯­å¥ã€‚</p>
<p>å…¸å‹ç”¨æ³•ï¼š</p>
<ul>
<li>ä¸»çº¿ç¨‹ï¼ˆ<code>await</code>ï¼‰ç­‰å¾…å¤šä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼ˆ<code>countDown</code>ï¼‰ï¼›</li>
<li>ä¸»çº¿ç¨‹é€šçŸ¥ï¼ˆ<code>countDown</code>ï¼‰æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹æ‰§è¡Œï¼ˆ<code>await</code>ï¼‰ï¼ŒCountDownLatch è®¡æ•°å™¨éœ€è¦åˆå§‹åŒ–ä¸º 1ã€‚</li>
</ul>
<h3><a id="cyclicbarrier" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CyclicBarrier</h3>
<p>åŸºäº <code>ReentrantLock</code> å®ç°ï¼Œå’Œ <code>CountDownLatch</code> ç±»ä¼¼ä½†æ›´å¼ºå¤§ï¼Œè®©ä¸€ç»„çº¿ç¨‹å…¨éƒ¨åˆ°è¾¾åŒæ­¥ç‚¹åï¼Œè¿™ç»„çº¿ç¨‹æ‰å‘åæ‰§è¡Œã€‚<br />
æä¾›äº†ä¸€ä¸ªé«˜çº§æ„é€ å‡½æ•°ï¼Œèƒ½ä¼ å…¥ä¸€ä¸ª <code>Runnable</code>ï¼Œæ‰€æœ‰çº¿ç¨‹åˆ°è¾¾å±éšœåï¼Œä¼˜å…ˆæ‰§è¡Œ <code>Runnable</code>ã€‚</p>
<p>æ„é€ æ—¶æŒ‡å®šæ‹¦æˆªçš„æ•°é‡ count = Nï¼Œæ¯ä¸ªçº¿ç¨‹è°ƒç”¨ <code>await()</code> ä½¿å¾— count - 1ï¼Œå¦‚æœ count = 0ï¼Œæ‰§è¡Œæ„é€ å™¨ä¼ å…¥çš„ä»»åŠ¡ï¼Œç„¶åé€šçŸ¥æ‰€æœ‰é˜»å¡çº¿ç¨‹æ‰§è¡Œï¼›å¦‚æœ count &gt; 0ï¼Œå°±è‡ªæ—‹é˜»å¡ã€‚</p>
<blockquote>
<p><code>CyclicBarrier</code> VS <code>CountDownLatch</code></p>
<ol>
<li><code>CyclicBarrier</code> æ˜¯å¤šä¸ªçº¿ç¨‹åœ¨ä»»æ„ä¸€ä¸ªæ²¡æœ‰å®Œæˆæ—¶ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½ç­‰å¾…ï¼ˆå†…éƒ¨ç­‰å¾…ï¼‰ï¼›<code>CountDownLatch</code> æ˜¯ä¸€/å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»– N ä¸ªçº¿ç¨‹å®ŒæˆæŸä»¶äº‹æƒ…ï¼ˆç­‰å¾…å¤–éƒ¨çº¿ç¨‹ï¼‰</li>
<li><code>CyclicBarrier</code> è°ƒç”¨ <code>await()</code> å‡ä¸€åä¼šé˜»å¡ç›´åˆ°è®¡æ•°å™¨ä¸º 0ï¼›<code>CountDownLatch</code> è°ƒç”¨ <code>countDown()</code> å‡ä¸€åç»§ç»­è¿è¡Œï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨ <code>await()</code> é˜»å¡ç›´åˆ°è®¡æ•°å™¨ä¸º 0</li>
<li><code>CountDownLatch</code> æ˜¯ä¸€æ¬¡æ€§çš„ï¼›<code>CyclicBarrier</code> æä¾› reset æ–¹æ³•</li>
</ol>
</blockquote>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16227419427125.html">CAS</a></h1>
			<p class="meta"><time datetime="2021-06-04T01:39:02+08:00" 
			pubdate data-updated="true">2021/06/04</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#%E5%8E%9F%E5%AD%90%E7%B1%BB%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">åŸå­ç±»æºç åˆ†æ</a>
<ul>
<li><a href="#compareandswapint">compareAndSwapInt</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A0">å®ç°è‡ªåŠ </a></li>
</ul>
</li>
<li><a href="#%E7%BC%BA%E7%82%B9">ç¼ºç‚¹</a></li>
<li><a href="#%E8%A7%A3%E5%86%B3aba">è§£å†³ ABA</a></li>
</ul>
</div>
<blockquote>
<p>CAS: Compare And Swap, æ¯”è¾ƒå¹¶äº¤æ¢, CPU å¹¶å‘åŸè¯­, å½“å†…å­˜ä¸­çš„å€¼å’ŒæœŸæœ›å€¼ç›¸ç­‰æ‰è®¾ç½®æ–°å€¼</p>
</blockquote>
<p><code>java.util.concurrent.atomic</code> åŒ…ä¸‹çš„ç±»æ˜¯åŸå­ç±»ï¼Œå†…éƒ¨ä½¿ç”¨ <code>Unsafe</code> ç±»è°ƒç”¨ C++ æœ¬åœ°æ–¹æ³•ï¼Œä»è€Œåº•å±‚ä½¿ç”¨äº† CAS ä¿è¯æ“ä½œçš„åŸå­æ€§</p>
<h2><a id="%E5%8E%9F%E5%AD%90%E7%B1%BB%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>åŸå­ç±»æºç åˆ†æ</h2>
<p>å‚è€ƒ <a href="https://juejin.cn/post/6844903558937051144">Java CAS åŸç†å‰–æ</a>ï¼š</p>
<h3><a id="compareandswapint" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>compareAndSwapInt</h3>
<pre><code class="language-java">compareAndSwapInt(Object var1, long var2, int var4, int var5);
</code></pre>
<ul>
<li>var1 æ˜¯å½“å‰ Unsafe ç±»ï¼Œvar2 æ˜¯åŸå­ç±»ä¸­ value å±æ€§çš„åç§»é‡ï¼Œæœ‰äº†è¿™ä¸¤ä¸ªå€¼ï¼Œå°±å¯ä»¥ä»å†…å­˜ä¸­å–å¾— value çš„å€¼ã€‚</li>
<li>var4 æ˜¯æœŸæœ›å€¼ï¼ŒCAS åŸç†å°±æ˜¯æ¯”è¾ƒå†…å­˜å€¼å’ŒæœŸæœ›å€¼æ˜¯å¦ç›¸åŒæ¥å†³å®šæ˜¯å¦æ›´æ–°</li>
<li>var5 æ˜¯è¦è®¾ç½®çš„æ–°å€¼</li>
<li><strong>æ€»ç»“</strong>ï¼šå¦‚æœé€šè¿‡ varã€var2 å–å‡ºæ¥çš„å†…å­˜å€¼å’Œ var4 ç›¸åŒï¼Œé‚£ä¹ˆå°†å†…å­˜å€¼æ›´æ–°ä¸º var5ã€‚åˆ¤æ–­æ¯”è¾ƒè¿™ä¸ªè¿‡ç¨‹æ˜¯åŸå­çš„ï¼Œåº•å±‚ä½¿ç”¨ <code>cmpxchgl</code> æŒ‡ä»¤ï¼Œç»™æ€»çº¿åŠ é”ï¼ŒåŒä¸€èŠ¯ç‰‡ä¸Šçš„å…¶ä»–å¤„ç†å™¨å°±æš‚æ—¶ä¸èƒ½é€šè¿‡æ€»çº¿è®¿é—®å†…å­˜</li>
</ul>
<h3><a id="%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A0" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å®ç°è‡ªåŠ </h3>
<pre><code class="language-java">public final int getAndAddInt(Object var1, long var2, int var4) {
    int var5;
    do {
        var5 = this.getIntVolatile(var1, var2);
    } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));

    return var5;
}
</code></pre>
<ul>
<li>é¦–å…ˆä»å†…å­˜å–å‡ºå€¼ var5 ä½œä¸ºæœŸæœ›å€¼ï¼Œç„¶åå°è¯•åŠ  1 åæ›´æ–°å†…å­˜å€¼ï¼Œæ›´æ–°çš„å‰ææ˜¯åˆšåˆšå–å¾— var5 (æœŸæœ›å€¼) å’Œç°åœ¨å†…å­˜å€¼ç›¸åŒï¼ˆæ²¡æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼‰ï¼Œè¿™ä¸€æ­¥ä½¿ç”¨ <code>compareAndSwapInt</code>ï¼Œwhile å¾ªç¯æ˜¯ä¸€ä¸ªä¹è§‚é”ï¼Œä»–ä¼šåˆ¤æ–­å¦‚æœåˆšåˆšå–å‡ºæ¥çš„å€¼è¢«ä¿®æ”¹äº†ï¼Œå°±å†æ¬¡å°è¯•é‡æ–°è·å–æ–°çš„å€¼åŠ  1</li>
</ul>
<h2><a id="%E7%BC%BA%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ç¼ºç‚¹</h2>
<ul>
<li>å¼€é”€å¤§ï¼šåœ¨å¹¶å‘é‡æ¯”è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œå¦‚æœè®¸å¤šçº¿ç¨‹åå¤ç«äº‰ï¼Œå°è¯•æ›´æ–°æŸä¸€ä¸ªå˜é‡ï¼Œå´åˆä¸€ç›´æ›´æ–°ä¸æˆåŠŸï¼Œä¼šç»™CPUå¸¦æ¥å¾ˆå¤§çš„å‹åŠ›ã€‚</li>
<li>åªæ˜¯ä¸€ä¸ªå˜é‡çš„åŸå­æ€§æ“ä½œ</li>
<li>ABA é—®é¢˜ï¼šAçº¿ç¨‹è¦ä¿®æ”¹å˜é‡ï¼ŒBçº¿ç¨‹å–åˆ°äº†è¯¥å˜é‡ä¿®æ”¹äº†ï¼Œç„¶ååˆæ”¹å›äº†æœ€åˆå€¼ï¼Œæ‰€ä»¥Aä¾ç„¶èƒ½å¤Ÿä¿®æ”¹æˆåŠŸ</li>
</ul>
<h2><a id="%E8%A7%A3%E5%86%B3aba" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>è§£å†³ ABA</h2>
<p>ä½¿ç”¨å¸¦ç‰ˆæœ¬å·çš„åŸå­å¼•ç”¨ç±» <code>AtomicStampedReference</code>ï¼Œå®ƒæºå¸¦ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œæ¯æ¬¡æ›´æ–°éƒ½ä½¿ç‰ˆæœ¬å·åŠ  1ã€‚<code>compareAndSet</code> é¦–å…ˆæ£€æŸ¥å½“å‰å¼•ç”¨æ˜¯å¦ç­‰äºé¢„æœŸå¼•ç”¨ï¼Œå¹¶ä¸”å½“å‰æ ‡å¿—æ˜¯å¦ç­‰äºé¢„æœŸæ ‡å¿—ï¼Œå¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å¼•ç”¨å’Œè¯¥æ ‡å¿—çš„å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚</p>
<pre><code class="language-java">// å¤§å‘ï¼šç”±äºå­˜å‚¨çš„å€¼æ˜¯ Objectï¼Œ127 è‡ªåŠ¨è£…ç®±æˆ Ineger ç±»ï¼Œè€Œ Ineger ç¼“å­˜æ± èŒƒå›´æ˜¯ -128ï½127ï¼Œ
// è¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œä¼šé‡æ–°åœ¨å †ä¸­ new ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å“ªæ€•å€¼ç›¸åŒåœ°å€ä¹Ÿä¸åŒï¼Œè€Œ AtomicStampedReference
// å†…éƒ¨æ°æ°æ˜¯ç”¨ `==` æ¯”è¾ƒçš„åœ°å€ï¼Œæ‰€ä»¥è¿™é‡Œå¦‚æœè¶…å‡ºç¼“å­˜èŒƒå›´ï¼Œä¸‹é¢ CAS ä¼šå¤±è´¥
AtomicStampedReference&lt;Integer&gt; atomicStampedReference = new AtomicStampedReference(127, 1);

@Test
public void test4() {
    int stamp = atomicStampedReference.getStamp();
    atomicStampedReference.compareAndSet(127, 21, stamp, stamp + 1);
    // stamp = atomicStampedReference.getStamp(); // ä¸åŠ è¿™ä¸€å¥è·å–æœ€æ–°ç‰ˆæœ¬å·ï¼Œä¸‹é¢å°±ä¼šæ‰§è¡Œå¤±è´¥ï¼Œæœ€ç»ˆè¾“å‡º 21
    atomicStampedReference.compareAndSet(21, 22, stamp, stamp + 1);
    System.out.println(atomicStampedReference.getReference());
}
</code></pre>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16227416766193.html">ç”Ÿäº§è€…æ¶ˆè´¹è€…</a></h1>
			<p class="meta"><time datetime="2021-06-04T01:34:36+08:00" 
			pubdate data-updated="true">2021/06/04</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#synchronized%E7%89%88%E6%9C%AC%EF%BC%88-synchronized-wait-notify%EF%BC%89">synchronized ç‰ˆæœ¬ï¼ˆ<code>synchronized</code> <code>wait</code> <code>notify</code>ï¼‰</a></li>
<li><a href="#juc%E7%89%88%E6%9C%AC%EF%BC%88-lock-await-signal%EF%BC%89">JUC ç‰ˆæœ¬ï¼ˆ<code>Lock</code> <code>await</code> <code>signal</code>ï¼‰</a></li>
</ul>
</div>
<h2><a id="synchronized%E7%89%88%E6%9C%AC%EF%BC%88-synchronized-wait-notify%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>synchronized ç‰ˆæœ¬ï¼ˆ<code>synchronized</code> <code>wait</code> <code>notify</code>ï¼‰</h2>
<p>ä½¿ç”¨ <code>synchronized</code> åŠ é”, <code>wait</code> å’Œ <code>notify</code> å®ç° (ç­‰å¾… ä¸šåŠ¡ é€šçŸ¥) <strong>åˆ¤æ–­ç­‰å¾…çš„æ—¶å€™ä¸è¦ä½¿ç”¨ if, è¦ä½¿ç”¨ while, é˜²æ­¢è¶…è¿‡ä¸¤ä¸ªçº¿ç¨‹æ—¶çš„è™šå‡å”¤é†’é—®é¢˜</strong><br />
ï¼ˆæ‹¿ä¸¤ä¸ªåŠ æ³•çº¿ç¨‹Aã€Bæ¥è¯´ï¼Œæ¯”å¦‚Aå…ˆæ‰§è¡Œï¼Œæ‰§è¡Œæ—¶è°ƒç”¨äº†waitæ–¹æ³•ï¼Œé‚£å®ƒä¼šç­‰å¾…ï¼Œæ­¤æ—¶ä¼šé‡Šæ”¾é”ï¼Œé‚£ä¹ˆçº¿ç¨‹Bè·å¾—é”å¹¶ä¸”ä¹Ÿä¼šæ‰§è¡Œwaitæ–¹æ³•ï¼Œä¸¤ä¸ªåŠ çº¿ç¨‹ä¸€èµ·ç­‰å¾…è¢«å”¤é†’ã€‚æ­¤æ—¶å‡çº¿ç¨‹ä¸­çš„æŸä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•å¹¶ä¸”å”¤é†’äº†è¿™ä¿©åŠ çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¿©åŠ çº¿ç¨‹ä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Œå…¶ä¸­Aè·å–äº†é”å¹¶ä¸”åŠ 1ï¼Œæ‰§è¡Œå®Œæ¯•ä¹‹åBå†æ‰§è¡Œã€‚å¦‚æœæ˜¯ifçš„è¯ï¼Œé‚£ä¹ˆAä¿®æ”¹å®Œnumåï¼ŒBä¸ä¼šå†å»åˆ¤æ–­numçš„å€¼ï¼Œç›´æ¥ä¼šç»™num+1ã€‚å¦‚æœæ˜¯whileçš„è¯ï¼ŒAæ‰§è¡Œå®Œä¹‹åï¼ŒBè¿˜ä¼šå»åˆ¤æ–­numçš„å€¼ï¼Œå› æ­¤å°±ä¸ä¼šæ‰§è¡Œã€‚ï¼‰</p>
<pre><code class="language-java">class ProducerCustomer {
    private int num;
    
    public synchronized void product() throws InterruptedException {
        while (num &gt; 0) { // ä½¿ç”¨ while é˜²æ­¢è™šå‡å”¤é†’
            this.wait(); // ç­‰å¾…æ—¶é‡Šæ”¾é”
        }
        num++;
        System.out.println(Thread.currentThread().getName() + &quot; --&gt; &quot; + num);
        this.notifyAll();
    }
    
    public synchronized void custom() throws InterruptedException {
        while (num == 0) {
            this.wait();
        }
        num--;
        System.out.println(Thread.currentThread().getName() + &quot; --&gt; &quot; + num);
        this.notifyAll();
    }
}
</code></pre>
<h2><a id="juc%E7%89%88%E6%9C%AC%EF%BC%88-lock-await-signal%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>JUC ç‰ˆæœ¬ï¼ˆ<code>Lock</code> <code>await</code> <code>signal</code>ï¼‰</h2>
<p>ä½¿ç”¨ Lock åŠ é”, Condition å¯¹è±¡ä¸­çš„ <code>await</code> å’Œ <code>signal</code> / <code>SignalAll</code> è¿›è¡Œç­‰å¾…å’Œå”¤é†’</p>
<pre><code class="language-java">class ProducerCustomerJUC {
    private int num = 0;
    private Lock lock = new ReentrantLock();
    private Condition condition = lock.newCondition();
    
    public void product() {
        lock.lock();
        try {
            while (num &gt; 0) condition.await();
            num++;
            System.out.println(Thread.currentThread().getName() + &quot; --&gt; &quot; + num);
            condition.signalAll();
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            lock.unlock();
        }
    }
    
    public void custom() {
        lock.lock();
        try {
            while (num == 0) condition.await();
            num--;
            System.out.println(Thread.currentThread().getName() + &quot; --&gt; &quot; + num);
            condition.signalAll();
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            lock.unlock();
        }
    }
}
</code></pre>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16227359619314.html">å•ä¾‹æ¨¡å¼</a></h1>
			<p class="meta"><time datetime="2021-06-03T23:59:21+08:00" 
			pubdate data-updated="true">2021/06/03</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#%E9%A5%BF%E6%B1%89%E5%BC%8F">é¥¿æ±‰å¼</a></li>
<li><a href="#dcl%E6%87%92%E6%B1%89%E5%BC%8F">DCL æ‡’æ±‰å¼</a></li>
<li><a href="#%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB%E5%8D%95%E4%BE%8B%EF%BC%88%E5%8D%95%E4%BE%8B%E6%8C%81%E6%9C%89%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89">é™æ€å†…éƒ¨ç±»å•ä¾‹ï¼ˆå•ä¾‹æŒæœ‰è€…æ¨¡å¼ï¼‰</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%9E%9A%E4%B8%BE%E7%B1%BB%EF%BC%88%E6%9C%80%E5%AE%89%E5%85%A8%EF%BC%8C%E6%9C%80%E6%8E%A8%E8%8D%90%EF%BC%89">ä½¿ç”¨æšä¸¾ç±»ï¼ˆæœ€å®‰å…¨ï¼Œæœ€æ¨èï¼‰</a></li>
</ul>
</div>
<h2><a id="%E9%A5%BF%E6%B1%89%E5%BC%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>é¥¿æ±‰å¼</h2>
<pre><code class="language-java">class Singleton {
    private final static Singleton instance = new Singleton();
    private Singleton() {}
    public static Singleton getInstance() {
        return instance;
    }
}
</code></pre>
<h2><a id="dcl%E6%87%92%E6%B1%89%E5%BC%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>DCL æ‡’æ±‰å¼</h2>
<p>ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯ <code>volatile</code> ï¼Ÿ<br />
<code>new SingletonV2();</code> æ‰§è¡Œçš„æ—¶å€™åˆ†ä¸ºä¸‰æ­¥ï¼š<br />
1âƒ£ï¸ï¼šåˆ†é…å†…å­˜ç©ºé—´<br />
2âƒ£ï¸ï¼šæ‰§è¡Œæ„é€ å™¨ï¼Œåˆå§‹åŒ–å¯¹è±¡<br />
3âƒ£ï¸ï¼šå°†å¼•ç”¨æŒ‡å‘è¿™ä¸ªç©ºé—´<br />
ç„¶è€Œç”±äºæŒ‡ä»¤é‡æ’ï¼Œå®é™…æ‰§è¡Œé¡ºåºå¯èƒ½æ˜¯ 1âƒ£ï¸ -&gt; 3âƒ£ï¸ -&gt; 2âƒ£ï¸ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å·²ç»æ‰§è¡Œå®Œ 3âƒ£ï¸ï¼Œè¿˜æ²¡æœ‰æ‰§è¡Œ 2âƒ£ï¸ æ—¶ï¼Œè¿™æ—¶å¼•ç”¨å·²ç»æŒ‡å‘äº†å †å†…å­˜ä¸€å—åœ°å€ï¼Œä½†æ˜¯è¿™ä¸ªåœ°å€è¿˜æ²¡æœ‰æ‰§è¡Œæ„é€ å™¨åˆå§‹åŒ–ã€‚å¦ä¸€ä¸ªçº¿ç¨‹è¿›å…¥æ–¹æ³•ç›´æ¥åˆ¤æ–­ <code>instance != null</code>ï¼Œç›´æ¥æŠŠè¿™ä¸ªå¼•ç”¨è¿”å›æ¥ç€å»ç”¨äº†ï¼Œå°±ä¼šå‘ç”Ÿé—®é¢˜ï¼Œæ‰€ä»¥å¿…é¡»åŠ  <code>volatile</code> é˜²æ­¢æŒ‡ä»¤é‡æ’ã€‚</p>
<pre><code class="language-java">class SingletonV2 {
    // å¿…é¡»æ˜¯ volatile
    private volatile static SingletonV2 instance = null;
    private SingletonV2() {}

    public static SingletonV2 getInstance() {
        // è¯¥å¤„åˆ¤æ–­ï¼Œä¸»è¦ä½œç”¨æ˜¯æå‡æ€§èƒ½, å› ä¸ºå¦‚æœæ²¡æœ‰è¯¥å¤„åˆ¤æ–­ï¼Œä¼šç›´æ¥å»è·å–é”å¯¹è±¡ï¼Œå†åˆ¤æ–­æ˜¯å¦å·²ç»åˆ›å»ºå¯¹è±¡
        if (instance == null) {
            //å°†å½“å‰ç±»ä½œä¸ºé”å¯¹è±¡ï¼Œè·å–è¯¥é”åæ‰§è¡Œè¯¥éƒ¨åˆ†èŒƒå›´çš„ä»£ç é€»è¾‘
            synchronized (SingletonV2.class) {
                if (instance == null) {
                    instance = new SingletonV2();
                }
            }
        }

        return instance;
    }
}
</code></pre>
<h2><a id="%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB%E5%8D%95%E4%BE%8B%EF%BC%88%E5%8D%95%E4%BE%8B%E6%8C%81%E6%9C%89%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>é™æ€å†…éƒ¨ç±»å•ä¾‹ï¼ˆå•ä¾‹æŒæœ‰è€…æ¨¡å¼ï¼‰</h2>
<p>åŸç†ï¼šJVM åœ¨åŠ è½½å¤–éƒ¨ç±»çš„è¿‡ç¨‹ä¸­, æ˜¯ä¸ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»çš„, åªæœ‰å†…éƒ¨ç±»çš„å±æ€§/æ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰ä¼šè¢«åŠ è½½, å¹¶åˆå§‹åŒ–å…¶é™æ€å±æ€§ã€‚è¿™æ ·å°±ä¿è¯æ‡’æ±‰å¼æ‡’åŠ è½½çš„æ•ˆæœï¼ŒåŒæ—¶åˆæ‹¥æœ‰äº†é¥¿æ±‰å¼çº¿ç¨‹å®‰å…¨çš„ä¼˜ç‚¹ã€‚</p>
<pre><code class="language-java">class SingletonV3 {
    
    private SingletonV3(){}
    
    private static class InstanceHolder {
        private final static SingletonV3 singletonV3 = new SingletonV3();
    }
    
    public SingletonV3 getInstance() {
        return InstanceHolder.singletonV3;
    }
}
</code></pre>
<h2><a id="%E4%BD%BF%E7%94%A8%E6%9E%9A%E4%B8%BE%E7%B1%BB%EF%BC%88%E6%9C%80%E5%AE%89%E5%85%A8%EF%BC%8C%E6%9C%80%E6%8E%A8%E8%8D%90%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä½¿ç”¨æšä¸¾ç±»ï¼ˆæœ€å®‰å…¨ï¼Œæœ€æ¨èï¼‰</h2>
<p>ä¸‰ç§å•ä¾‹æ¨¡å¼éƒ½ä¸æ˜¯ç»å¯¹å®‰å…¨çš„ï¼š</p>
<ul>
<li>ç”¨ç§æœ‰åŒ–æ„é€ å™¨å¹¶ä¸ä¿é™©ï¼Œå› ä¸ºå®ƒæŠµå¾¡ä¸äº†åå°„æ”»å‡»</li>
<li>åºåˆ—åŒ–åå†ååºåˆ—åŒ–ï¼Œå¾—åˆ°çš„å¯¹è±¡å°±ä¼šæ”¹å˜ï¼Œä¹Ÿä¸å®‰å…¨</li>
</ul>
<p>æšä¸¾ç±»å‹æ˜¯æ‰€ç”¨å•ä¾‹å®ç°ä¸­å”¯ä¸€ä¸€ç§ä¸ä¼šè¢«ç ´åçš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œå› ä¸º Java åº•å±‚ä¸å…è®¸é€šè¿‡åå°„åˆ›å»ºæšä¸¾ç±»ï¼ŒnewInstance åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼šæ£€æŸ¥è¯¥ç±»<strong>æ˜¯å¦ENUMä¿®é¥°</strong>ï¼Œå¦‚æœæ˜¯åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œåå°„å¤±è´¥ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿæ˜¯åºåˆ—åŒ–å®‰å…¨çš„</p>
<pre><code class="language-java">enum SingletonV4 {
    INSTANCE;
}
</code></pre>
<p>å‚è€ƒï¼š<a href="https://cloud.tencent.com/developer/article/1497592">Javaå•ä¾‹æ¨¡å¼çš„7ç§å†™æ³•ä¸­ï¼Œä¸ºä½•ç”¨Enumæšä¸¾å®ç°è¢«è®¤ä¸ºæ˜¯æœ€å¥½çš„æ–¹å¼ï¼Ÿ</a></p>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16227146556632.html">Stram æµè®¡ç®—</a></h1>
			<p class="meta"><time datetime="2021-06-03T18:04:15+08:00" 
			pubdate data-updated="true">2021/06/03</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#stream">Stream</a></li>
<li><a href="#parallelstream">parallelStream</a>
<ul>
<li><a href="#forkjoin">ForkJoin</a></li>
</ul>
</li>
</ul>
</div>
<h2><a id="stream" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stream</h2>
<p>Stream ä½¿ç”¨ä¸€ç§ç±»ä¼¼ SQL è¯­å¥çš„ç›´è§‚æ–¹å¼ï¼Œæ¥å¯¹ Java é›†åˆè¿›è¡Œæ“ä½œã€‚</p>
<pre><code class="language-java">User a1 = new User(1, &quot;a&quot;, 21);
User a2 = new User(2, &quot;b&quot;, 22);
User a3 = new User(3, &quot;c&quot;, 23);
User a4 = new User(4, &quot;d&quot;, 24);
User a5 = new User(5, &quot;e&quot;, 25);
User a6 = new User(6, &quot;f&quot;, 26);
List&lt;User&gt; users = Arrays.asList(a1, a2, a3, a4, a5, a6);
users.stream()
        .filter((u)-&gt;{return u.id % 2 == 0;})
        .filter((u)-&gt;{return u.age &gt; 23;})
        .map((u)-&gt;{
            u.name = u.name.toUpperCase();
            return u;
        })
        .sorted((u1, u2)-&gt;{return u2.compareTo(u1);})
        .forEach(System.out::println);
</code></pre>
<h2><a id="parallelstream" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>parallelStream</h2>
<p>å¹¶è¡Œæµå†…éƒ¨é»˜è®¤ä½¿ç”¨äº† forkjoinï¼Œé»˜è®¤çš„çº¿ç¨‹æ•°é‡å°±æ˜¯å¤„ç†å™¨æ•°é‡ï¼ŒparallelStream é€‚ç”¨çš„åœºæ™¯æ˜¯CPUå¯†é›†å‹</p>
<pre><code class="language-java">long sum = LongStream.rangeClosed(0L,10_0000_0000L).parallel().reduce(0, Long::sum); // Long::sum æ–¹æ³•å¼•ç”¨
</code></pre>
<h3><a id="forkjoin" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ForkJoin</h3>
<p>Fork/Join æ¡†æ¶çš„æ ¸å¿ƒæ˜¯é‡‡ç”¨åˆ†æ²»æ³•çš„æ€æƒ³ï¼Œå°†ä¸€ä¸ªå¤§ä»»åŠ¡æ‹†åˆ†ä¸ºè‹¥å¹²äº’ä¸ä¾èµ–çš„å­ä»»åŠ¡ï¼ŒæŠŠè¿™äº›å­ä»»åŠ¡åˆ†åˆ«æ”¾åˆ°ä¸åŒçš„é˜Ÿåˆ—é‡Œï¼Œå¹¶ä¸ºæ¯ä¸ªé˜Ÿåˆ—åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹æ¥æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ã€‚åŒæ—¶ï¼Œä¸ºäº†æœ€å¤§é™åº¦åœ°æé«˜å¹¶è¡Œå¤„ç†èƒ½åŠ›ï¼Œé‡‡ç”¨äº†å·¥ä½œçªƒå–ç®—æ³•æ¥è¿è¡Œä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æŸä¸ªçº¿ç¨‹å¤„ç†å®Œè‡ªå·±å·¥ä½œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡åï¼Œå°è¯•å½“å…¶ä»–çº¿ç¨‹çš„å·¥ä½œé˜Ÿåˆ—ä¸­çªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å¤„ç†å®Œæ¯•ã€‚æ‰€ä»¥ä¸ºäº†å‡å°‘çº¿ç¨‹ä¹‹é—´çš„ç«äº‰ï¼Œé€šå¸¸ä¼šä½¿ç”¨åŒç«¯é˜Ÿåˆ—ï¼Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å¤´éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œï¼Œè€Œçªƒå–ä»»åŠ¡çš„çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å°¾éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œã€‚</p>
<p><img src="media/16227169516018/16227193640438.jpg" alt="" class="mw_img_center" style="width:562px;display: block; clear:both; margin: 0 auto;" /></p>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16227134041299.html">å‡½æ•°å¼æ¥å£</a></h1>
			<p class="meta"><time datetime="2021-06-03T17:43:24+08:00" 
			pubdate data-updated="true">2021/06/03</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"></div>
<p>åªæœ‰ä¸€ä¸ªæ–¹æ³•çš„æ¥å£ï¼Œé…åˆ lambda è¡¨è¾¾å¼å¯ä»¥ç®€åŒ–ç¼–ç¨‹æ¨¡å‹</p>
<ol>
<li>
<p><code>Function</code> å‡½æ•°å¼æ¥å£ï¼Œä¸€ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªè¿”å›</p>
<pre><code class="language-java">// Function&lt;String, String&gt; function = new Function&lt;String, String&gt;() {
//     @Override
//     public String apply(String s) {
//         return s + &quot;_funtion&quot;;
//     }
// };
Function&lt;String, String&gt; function = (s) -&gt; { return s + &quot;_funtion&quot;; }; // ä½¿ç”¨ lambda
System.out.println(function.apply(&quot;hello&quot;)); // hello_funtion
</code></pre>
</li>
<li>
<p><code>Predicate</code> æ–­å®šå¼æ¥å£ï¼Œä¸€ä¸ªè¾“å…¥ï¼Œè¿”å›å¸ƒå°”</p>
</li>
<li>
<p><code>Consumer</code> æ¶ˆè´¹å‹æ¥å£ï¼Œåªæœ‰è¾“å…¥ï¼Œæ— è¿”å›</p>
</li>
<li>
<p><code>Supplier</code> ä¾›ç»™å‹æ¥å£ï¼Œæ— è¾“å…¥ï¼Œæœ‰è¿”å›</p>
</li>
</ol>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16227100604511.html">çº¿ç¨‹æ± </a></h1>
			<p class="meta"><time datetime="2021-06-03T16:47:40+08:00" 
			pubdate data-updated="true">2021/06/03</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#%E4%B8%89%E4%B8%AA%E6%96%B9%E6%B3%95">ä¸‰ä¸ªæ–¹æ³•</a></li>
<li><a href="#%E4%B8%83%E4%B8%AA%E5%8F%82%E6%95%B0">ä¸ƒä¸ªå‚æ•°</a></li>
<li><a href="#%E5%9B%9B%E7%A7%8D%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5">å››ç§æ‹’ç»ç­–ç•¥</a></li>
<li><a href="#%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E6%A0%B8%E5%BF%83%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%95%B0%E9%87%8F">å¦‚ä½•ç¡®å®šæ ¸å¿ƒçº¿ç¨‹æ± æ•°é‡</a></li>
</ul>
</div>
<p>æ± åŒ–æŠ€æœ¯ï¼šäº‹å…ˆå‡†å¤‡å¥½ä¸€äº›èµ„æºï¼Œç”¨çš„æ—¶å€™æ‹¿å»ï¼Œç”¨å®Œè¿˜å›æ¥<br />
æ± åŒ–æŠ€æœ¯çš„å¥½å¤„:é™ä½èµ„æºæ¶ˆè€— (æ¯æ¬¡åˆ›å»ºã€é”€æ¯ååˆ†æµªè´¹èµ„æº)ã€æé«˜å“åº”é€Ÿåº¦ã€æ–¹ä¾¿ç®¡ç†ã€‚</p>
<h2><a id="%E4%B8%89%E4%B8%AA%E6%96%B9%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¸‰ä¸ªæ–¹æ³•</h2>
<pre><code class="language-java">ExecutorService executor1 = Executors.newSingleThreadExecutor(); // å•ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± 
ExecutorService executor2 = Executors.newFixedThreadPool(5); // æŒ‡å®šæ•°é‡çº¿ç¨‹çš„çº¿ç¨‹æ± 
ExecutorService executor3 = Executors.newCachedThreadPool(); // å¯ä¼¸ç¼©çš„çº¿ç¨‹æ± 
</code></pre>
<h2><a id="%E4%B8%83%E4%B8%AA%E5%8F%82%E6%95%B0" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¸ƒä¸ªå‚æ•°</h2>
<p>Executors ä¸‰ä¸ªæ–¹æ³•åº•å±‚éƒ½æ˜¯è¿”å›ä¸€ä¸ª ThreadPoolExecutor å¯¹è±¡ ã€‚æˆ‘ä»¬ä¸è¦ä½¿ç”¨Executors çš„æ–¹å¼åˆ›å»ºï¼Œå¯èƒ½ä¼šå¯¼è‡´ OOMï¼Œè¦é€šè¿‡åº•å±‚ ThreadPoolExecutor çš„æ–¹å¼</p>
<pre><code class="language-java">ExecutorService executor4 = new ThreadPoolExecutor(
                2, // é»˜è®¤æœ‰ 2 ä¸ªçº¿ç¨‹
                5, // æœ€å¤šæœ‰ 5 ä¸ªçº¿ç¨‹
                3, // éé»˜è®¤çº¿ç¨‹ç­‰å¾… 3s åé”€æ¯
                TimeUnit.SECONDS,
                new ArrayBlockingQueue&lt;&gt;(3), // é»˜è®¤çº¿ç¨‹æ»¡äº†åï¼Œæ–°è¯·æ±‚åœ¨é˜Ÿåˆ—ç­‰å¾…ï¼Œé˜Ÿåˆ—æ»¡äº†åå¼€å¯æ–°çº¿ç¨‹
                Executors.defaultThreadFactory(), 
                new ThreadPoolExecutor.AbortPolicy() // maximumPoolSize å’Œé˜Ÿåˆ—éƒ½æ»¡äº†ï¼Œè§¦å‘æ‹’ç»ç­–ç•¥);
</code></pre>
<h2><a id="%E5%9B%9B%E7%A7%8D%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å››ç§æ‹’ç»ç­–ç•¥</h2>
<pre><code class="language-java">AbortPolicy // ä¸¢æ‰ä»»åŠ¡ï¼ŒæŠ›å‡ºå¼‚å¸¸
CallerRunPolicy // è¿”å›ç»™å‘å‡ºè¯·æ±‚çš„çº¿ç¨‹æ‰§è¡Œï¼Œä¾‹å¦‚è¿”å›ç»™ main çº¿ç¨‹æ‰§è¡Œ
DiscardPolicy // ä¸¢æ‰å¼‚å¸¸ï¼Œä¸æŠ›å‡ºå¼‚å¸¸
DiscardOldestPolicy // é˜Ÿåˆ—æ»¡äº†ï¼Œå°è¯•å’Œæœ€æ—©çš„ç«äº‰ï¼Œä¸æŠ›å‡ºå¼‚å¸¸
</code></pre>
<h2><a id="%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E6%A0%B8%E5%BF%83%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%95%B0%E9%87%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å¦‚ä½•ç¡®å®šæ ¸å¿ƒçº¿ç¨‹æ± æ•°é‡</h2>
<p>çº¿ç¨‹æ•°=cpuå¯ç”¨æ ¸å¿ƒæ•°/ï¼ˆ1-é˜»å¡ç³»æ•°ï¼‰ï¼Œå…¶ä¸­é˜»å¡ç³»æ•°çš„å–å€¼åœ¨[0,1]ä¹‹é—´ã€‚è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„é˜»å¡ç³»æ•°ä¸º0ï¼Œè€ŒIOå¯†é›†å‹ä»»åŠ¡çš„é˜»å¡ç³»æ•°åˆ™æ¥è¿‘1ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬è®©çº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œä¸ä¼šæ˜¯å•ä¸€çš„è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œæˆ–è€…å•ä¸€çš„IOå¯†é›†å‹ä»»åŠ¡ï¼Œé€šå¸¸ä¼šå¤¹æ‚ç€ã€‚é‚£ä¹ˆå°±éœ€è¦æˆ‘ä»¬å»è®¡ç®—é˜»å¡ç³»æ•°äº†ã€‚é˜»å¡ç³»æ•°çš„å®šä¹‰å°±æ˜¯æ‰§è¡Œè¯¥ä»»åŠ¡é˜»å¡çš„æ—¶é—´ä¸ï¼ˆé˜»å¡æ—¶é—´+è®¡ç®—æ—¶é—´ï¼‰çš„æ¯”å€¼ï¼Œä¹Ÿå°±æ˜¯w/(w+c)ã€‚</p>
<p>ä¸€èˆ¬ç»éªŒï¼š IOå¯†é›†å‹ï¼š2å€cpuå¯ç”¨çº¿ç¨‹æ•°ï¼›è®¡ç®—å¯†é›†å‹ï¼šcpuå¯ç”¨æ ¸æ•°</p>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16227068332225.html">é˜»å¡é˜Ÿåˆ—</a></h1>
			<p class="meta"><time datetime="2021-06-03T15:53:53+08:00" 
			pubdate data-updated="true">2021/06/03</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#blockingqueue">BlockingQueue</a>
<ul>
<li><a href="#%E5%9B%9B%E7%BB%84api">å››ç»„ API</a></li>
</ul>
</li>
<li><a href="#synchronousqueue">SynchronousQueue</a></li>
</ul>
</div>
<h2><a id="blockingqueue" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>BlockingQueue</h2>
<p><code>java.util.concurrent.BlockingQueue</code> æ¥å£æœ‰ä»¥ä¸‹é˜»å¡é˜Ÿåˆ—çš„å®ç°ï¼š<br />
FIFO é˜Ÿåˆ— ï¼š<code>LinkedBlockingQueue</code>ã€<code>ArrayBlockingQueue</code>ï¼ˆå›ºå®šé•¿åº¦ï¼‰<br />
ä¼˜å…ˆçº§é˜Ÿåˆ— ï¼š<code>PriorityBlockingQueue</code></p>
<p>æä¾›äº†é˜»å¡çš„ <code>take()</code> å’Œ <code>put()</code> æ–¹æ³•ï¼šå¦‚æœé˜Ÿåˆ—ä¸ºç©º <code>take()</code> å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰å†…å®¹ï¼›å¦‚æœé˜Ÿåˆ—ä¸ºæ»¡ <code>put()</code> å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰ç©ºé—²ä½ç½®ã€‚</p>
<p><img src="media/16227068332225/16227076040995.jpg" alt="" class="mw_img_center" style="width:453px;display: block; clear:both; margin: 0 auto;" /></p>
<h3><a id="%E5%9B%9B%E7%BB%84api" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å››ç»„ API</h3>
<table>
<thead>
<tr>
<th>æ–¹å¼</th>
<th>æŠ›å‡ºå¼‚å¸¸</th>
<th>æœ‰è¿”å›å€¼</th>
<th>é˜»å¡ç­‰å¾…</th>
<th>è¶…æ—¶ç­‰å¾…</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ·»åŠ </td>
<td><code>add()</code></td>
<td><code>offer()</code> (æ»¡åè¿”å› false)</td>
<td><code>put()</code> (æ»¡åä¸€ç›´ç­‰å¾…)</td>
<td><code>offer(e, timeout, TimeUnit)</code> (æ»¡åç­‰å¾…ä¸€æ®µæ—¶é—´)</td>
</tr>
<tr>
<td>ç§»å‡º</td>
<td><code>remove()</code></td>
<td><code>poll()</code> ï¼ˆç©ºæ—¶è¿”å› nullï¼‰</td>
<td><code>take()</code> (ç©ºæ—¶ä¸€ç›´ç­‰å¾…)</td>
<td><code>poll(timeout, TimeUnit)</code> (ç©ºæ—¶ä¸€ç›´ç­‰å¾…)</td>
</tr>
<tr>
<td>åˆ¤æ–­é¦–å…ƒç´ </td>
<td><code>element()</code></td>
<td><code>peek()</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2><a id="synchronousqueue" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SynchronousQueue</h2>
<p>ä»æ•ˆæœä¸Šçœ‹ï¼Œä»–çš„å®¹é‡æ˜¯ 1ï¼Œputäº†ä¸€ä¸ªå…ƒç´ ï¼Œå¿…é¡»å…ˆä»é‡Œé¢ take å–å‡ºæ¥ï¼Œå¦åˆ™ä¸èƒ½å†ç»§ç»­ put ä¸‹ä¸€ä¸ªå…ƒç´ <br />
ä½†æ˜¯å®é™…ä¸Šå®ƒä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„é˜Ÿåˆ—, ä¸å­˜å‚¨å…ƒç´ ï¼Œå®ƒç»´æŠ¤ä¸€ç»„çº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹åœ¨ç­‰å¾…ç€æŠŠå…ƒç´ åŠ å…¥æˆ–ç§»å‡ºé˜Ÿåˆ—ã€‚put å’Œ take éƒ½åœ¨ç­‰å¾…ï¼Œput çº¿ç¨‹ç›´æ¥æŠŠå®ƒäº¤ä»˜ç»™ take çº¿ç¨‹ï¼Œçœå»äº†åŠ å…¥å–å‡ºé˜Ÿåˆ—çš„å»¶è¿Ÿã€‚</p>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16226447097561.html">è¾…åŠ©ç±»</a></h1>
			<p class="meta"><time datetime="2021-06-02T22:38:29+08:00" 
			pubdate data-updated="true">2021/06/02</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#countdownlatch">CountDownLatch</a></li>
<li><a href="#cyclicbarrier">CyclicBarrier</a></li>
<li><a href="#semaphore%CB%88-sem%C9%99f%C9%94%CB%90r">Semaphore ([ËˆsemÉ™fÉ”Ër])</a></li>
</ul>
</div>
<h2><a id="countdownlatch" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CountDownLatch</h2>
<p>å‡æ³•è®¡æ•°å™¨ï¼Œæä¾›æ–¹æ³•ä½¿è®¡æ•°å™¨å‡1ï¼Œä»¥åŠç­‰å¾…è®¡æ•°å™¨å½’é›¶</p>
<pre><code class="language-java"> 
new CountDownLatch(int n) // è®¡æ•°
countDownLatch.countDown(); // -1 æ“ä½œ
countDownLath.await(); // ç­‰å¾…è®¡æ•°å™¨å½’é›¶, ç„¶åè¢«å”¤é†’å†å‘ä¸‹æ‰§è¡Œ
</code></pre>
<h2><a id="cyclicbarrier" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CyclicBarrier</h2>
<p>å…è®¸ä¸€ç»„çº¿ç¨‹å…¨éƒ¨åˆ°è¾¾å…±åŒå±éšœç‚¹åå†ç»§ç»­æ‰§è¡Œã€‚åŠ æ³•è®¡æ•°å™¨</p>
<pre><code class="language-java">CyclicBarrier cb = new CyclicBarrier(7, () -&gt; {
// è¡¨ç¤ºå½“æœ‰ n ä¸ªçº¿ç¨‹åˆ°è¾¾åï¼Œæ‰§è¡Œåé¢çš„ Runnable
    System.out.println(&quot;7ä¸ªçº¿ç¨‹éƒ½å·²ç»æ‰§è¡Œåˆ° barrier äº†&quot;);
});

for (int i = 0; i &lt; 7; i++) {
    new Thread(()-&gt;{
        System.out.println(&quot;ç¬¬ &quot; + Thread.currentThread().getName() + &quot; ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier&quot;);
        try {
            cb.await(); // çº¿ç¨‹åˆ°è¾¾è¿™é‡Œï¼Œè®¡æ•°å™¨ + 1 ç„¶åç­‰å¾… n ä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾åç»§ç»­æ‰§è¡Œ
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (BrokenBarrierException e) {
            e.printStackTrace();
        }
    }, String.valueOf(i)).start();
}
// ç¬¬ 0 ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier
// ç¬¬ 1 ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier
// ç¬¬ 2 ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier
// ç¬¬ 3 ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier
// ç¬¬ 4 ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier
// ç¬¬ 5 ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier
// ç¬¬ 6 ä¸ªçº¿ç¨‹å°†è¦æ‰§è¡Œåˆ° barrier
// 7ä¸ªçº¿ç¨‹éƒ½å·²ç»æ‰§è¡Œåˆ° barrier äº†
</code></pre>
<h2><a id="semaphore%CB%88-sem%C9%99f%C9%94%CB%90r" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Semaphore ([ËˆsemÉ™fÉ”Ër])</h2>
<p>ä¿¡å·é‡ï¼Œé™æµçš„æ—¶å€™å¯ä»¥ç”¨ï¼ˆä¾‹å¦‚ä¸‹é¢ä»£ç æ¨¡æ‹Ÿæœ‰3ä¸ªåœè½¦ä½ï¼Œ6ä¸ªè½¦è¦è¿›å…¥ï¼‰<br />
<code>acquire()</code> å¦‚æœå¤§äº 0 å°± -1ï¼Œå¦‚æœç­‰äº 0 å°±ç­‰å¾…<br />
<code>release()</code> é‡Šæ”¾ï¼Œå°†ä¿¡å·é‡ + 1ï¼Œå”¤é†’ç­‰å¾…çš„è¿›ç¨‹</p>
<pre><code class="language-java">Semaphore semaphore = new Semaphore(3);
for (int i = 0; i &lt; 6; i++) {
    new Thread(()-&gt;{
        try {
            semaphore.acquire(); // ç­‰å¾…è·å¾—
            System.out.println(Thread.currentThread().getName() + &quot; è¿›å…¥&quot;);
            TimeUnit.SECONDS.sleep(1);
            System.out.println(Thread.currentThread().getName() + &quot; ç¦»å¼€&quot;);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            semaphore.release();
        }
    }, String.valueOf(i)).start();
}
</code></pre>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16226423231626.html">Callable & Futrue</a></h1>
			<p class="meta"><time datetime="2021-06-02T21:58:43+08:00" 
			pubdate data-updated="true">2021/06/02</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#future">Future</a></li>
<li><a href="#runnablefuture-futretask">RunnableFuture &amp; FutreTask</a></li>
<li><a href="#completablefuture">CompletableFuture</a></li>
</ul>
</div>
<p>ä¹‹å‰åˆ›å»ºçº¿ç¨‹çš„ 2 ç§æ–¹å¼ï¼šä¸€ç§æ˜¯ç›´æ¥ç»§æ‰¿ <code>Thread</code>ï¼Œå¦å¤–ä¸€ç§å°±æ˜¯å®ç° <code>Runnable</code> æ¥å£ã€‚è¿™ 2 ç§æ–¹å¼éƒ½æœ‰ä¸€ä¸ªç¼ºé™·å°±æ˜¯ï¼šåœ¨æ‰§è¡Œå®Œä»»åŠ¡ä¹‹åæ— æ³•è·å–æ‰§è¡Œç»“æœã€‚<br />
<code>Callable</code> å’Œ <code>Runnable</code> ç±»ä¼¼ï¼Œéƒ½æ˜¯å¤šçº¿ç¨‹ä¸€ç§å®ç°æ–¹å¼ï¼Œä½†æ˜¯å¯ä»¥æœ‰è¿”å›å€¼ï¼Œå¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œä½¿ç”¨ <code>call()</code> æ–¹æ³•å¯åŠ¨</p>
<h2><a id="future" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Future</h2>
<p><code>Future</code> å°±æ˜¯å¯¹äºå…·ä½“çš„ <code>Runnable</code> æˆ–è€… <code>Callable</code> ä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœã€‚</p>
<pre><code class="language-java">ExecutorService threadPool = Executors.newFixedThreadPool(2);
Future&lt;Integer&gt; future = threadPool.submit((Callable&lt;Integer&gt;) () -&gt; {
    Thread.sleep(2000);
    return 0;
});
System.out.println(future.get()); // 0
threadPool.shutdown();
</code></pre>
<h2><a id="runnablefuture-futretask" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>RunnableFuture &amp; FutreTask</h2>
<p><code>RunnableFuture</code> å®ç°äº† <code>Runnable</code> æ¥å£å’Œ <code>Future</code> æ¥å£ï¼Œè€Œ <code>FutureTask</code> å®ç°äº† <code>RunnableFuture</code> æ¥å£ã€‚æ‰€ä»¥ <code>FutureTask</code> æ—¢å¯ä»¥ä½œä¸º <code>Runnable</code> è¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸º <code>Future</code> å¾—åˆ° <code>Callable</code> çš„è¿”å›å€¼ã€‚</p>
<pre><code class="language-java">import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.FutureTask;

public class CallableTest {
    public static void main(String[] args) {
        // å®ä¾‹åŒ– Callable å­ç±»å¯¹è±¡
        MyThread myThread = new MyThread();
        // ä½¿ç”¨ Callable å­ç±»å¯¹è±¡æ„é€  FutureTask å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸€ä¸ª Runnable çš„å®ç°ç±»ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ Thread è¿è¡Œï¼Œ
        FutureTask futureTask = new FutureTask(myThread);
        new Thread(futureTask, &quot;callable&quot;).start();

        // FutureTask åŒæ—¶ä¹Ÿæ—¶ Future çš„å®ç°ç±»ï¼Œæ‰€ä»¥å¯ä»¥å¯¹ä»»åŠ¡è¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœ
        try {
            String result = (String) futureTask.get(); // è¿™é‡Œå¯èƒ½äº§ç”Ÿé˜»å¡
            System.out.println(result);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        }
    }
}

class MyThread implements Callable&lt;String&gt; {
    @Override
    public String call() throws Exception {
        return &quot;hello Callable.&quot;;
    }
}
</code></pre>
<h2><a id="completablefuture" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CompletableFuture</h2>
<p>åŸå§‹ <code>Future</code> å¯ä»¥å¯¹æ‰§è¡Œçš„çº¿ç¨‹è¿›è¡Œç®¡ç†ç»“æœæŸ¥è¯¢ç­‰ï¼ˆé…åˆ <code>Callable</code>ï¼‰ï¼Œä½†æ˜¯æŸ¥è¯¢ç»“æœéœ€è¦é˜»å¡ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œæ•ˆæœä¸å¥½ã€‚<br />
ä» Java 8 å¼€å§‹å¼•å…¥äº† <code>CompletableFuture</code>ï¼Œå®ƒé’ˆå¯¹ <code>Future</code> åšäº†æ”¹è¿›ï¼Œå¯ä»¥äº‹å…ˆå®šä¹‰å¥½å›è°ƒæ–¹æ³•ï¼Œå½“å¼‚æ­¥ä»»åŠ¡å®Œæˆæˆ–è€…å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨å›è°ƒå¯¹è±¡çš„å›è°ƒæ–¹æ³•ã€‚</p>
<pre><code class="language-java">CompletableFuture.supplyAsync(Supplier).thenAccept(Consumer).exceptionally(Function);
// ä¼ å…¥çš„ supplyAsync å¯¹è±¡åœ¨å†…éƒ¨ä¼šè¢«è½¬æˆä¸€ä¸ª Runnable çº¿ç¨‹æ‰§è¡Œ
// æ‰§è¡Œå®Œæ¯•è‡ªåŠ¨è°ƒç”¨ thenAccept ä¼ å…¥çš„ Consumer
// å‡ºç°å¼‚å¸¸è‡ªåŠ¨è°ƒç”¨ exceptionally ä¼ å…¥çš„ Function
</code></pre>
<ul>
<li>ä½¿ç”¨</li>
</ul>
<pre><code class="language-java">CompletableFuture completableFuture = CompletableFuture.supplyAsync(() -&gt; {
    try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    System.out.println(&quot;hello completableFuture&quot;);
    return 1024;
}).thenAccept((t) -&gt; { // æˆåŠŸæ‰§è¡Œå®Œï¼Œè‡ªåŠ¨è°ƒç”¨è¿™ä¸ª
    System.out.println(t);
}).exceptionally((e)-&gt;{
    System.out.println(e);
    return null;
});

System.out.println(&quot;hello main1&quot;);
TimeUnit.SECONDS.sleep(2);
System.out.println(&quot;hello main2&quot;);

// ç»“æœ
// hello main1
// hello completableFuture // çº¿ç¨‹æ‰§è¡Œæ—¶è¾“å‡ºçš„è¯­å¥
// 1024 // çº¿ç¨‹æ­£å¸¸æ‰§è¡Œå®Œï¼Œè‡ªåŠ¨è°ƒç”¨ Consumer è¾“å‡ºçš„è¯­å¥
// hello main2
</code></pre>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16226261701341.html">JUC å®¹å™¨</a></h1>
			<p class="meta"><time datetime="2021-06-02T17:29:30+08:00" 
			pubdate data-updated="true">2021/06/02</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#copyonwritearraylist">CopyOnWriteArrayList</a></li>
<li><a href="#copyonwritearrayset">CopyOnWriteArraySet</a></li>
<li><a href="#concurrenthashmap">ConcurrentHashMap</a></li>
</ul>
</div>
<h2><a id="copyonwritearraylist" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CopyOnWriteArrayList</h2>
<p>å¹¶å‘ä¸‹ List æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„, å¦‚ä½•è§£å†³:</p>
<ul>
<li>ä½¿ç”¨ <code>Vector</code>, ä½¿ç”¨äº† <code>synchronized</code> æ–¹æ³•, ä¸ºäº†é˜²æ­¢éå†æ—¶å®¹å™¨è¢«ä¿®æ”¹æŠ¥é”™, å³ä½¿éå†æ—¶å®¹å™¨æˆ‘ä»¬ä¹Ÿè¦åŠ é”, æ•ˆç‡ä½</li>
<li>ä½¿ç”¨ <code>Collections.synchronizedList(List)</code> è½¬æ¢æˆå®‰å…¨çš„, å†…éƒ¨ä¹Ÿä½¿ç”¨äº† <code>synchronized</code> æ–¹æ³•</li>
<li>JUC è§£å†³æ–¹æ¡ˆ ( æ¨è ): ä½¿ç”¨ <code>CopyOnWriteArrayList</code>, æœ‰å†™æ“ä½œçš„æ—¶å€™ä¼š copy ä¸€ä»½æ•°æ®ï¼Œç„¶åå†™å®Œå†è®¾ç½®æˆæ–°çš„æ•°æ®, ä½¿å¾—è¿­ä»£æ—¶å…¶ä»–çº¿ç¨‹å¯ä»¥å¢åˆ å…ƒç´ , å¹¶ä¸”ä½¿ç”¨ lock, ä¿è¯çº¿ç¨‹å®‰å…¨, ç”±äºè¯»å–å’Œå†™çš„å†…å­˜ä¸æ˜¯åŒä¸€å—, è§£å†³äº†éå†æ—¶éœ€è¦åŠ é”çš„é—®é¢˜.</li>
</ul>
<p><code>CopyOnWriteArrayList</code> ç¼ºç‚¹:</p>
<ul>
<li>æ¯”è¾ƒè€—è´¹å†…å­˜</li>
<li>åªèƒ½ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„å®æ—¶ä¸€è‡´æ€§</li>
</ul>
<h2><a id="copyonwritearrayset" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CopyOnWriteArraySet</h2>
<p>å¹¶å‘ä¸‹ Set æ˜¯ä¸å®‰å…¨çš„, å’Œ List è§£å†³æ–¹æ¡ˆç±»ä¼¼:</p>
<ul>
<li>ä½¿ç”¨ <code>Collections.synchronizedSet(Set)</code> è½¬æ¢æˆå®‰å…¨çš„, å†…éƒ¨ä½¿ç”¨ <code>synchronized</code> æ–¹æ³•</li>
<li>JUC è§£å†³æ–¹æ¡ˆ: ä½¿ç”¨ <code>CopyOnWriteArraySet</code></li>
</ul>
<p><strong>hashSet åº•å±‚æ˜¯ hashMap</strong>: åˆ©ç”¨äº† map çš„ key æ˜¯æ— æ³•é‡å¤æ¥å®ç°çš„, æŠŠå€¼å½“ä½œ map çš„key å­˜èµ·æ¥, value æ˜¯ä¸€ä¸ªå…¨å±€å¸¸é‡</p>
<pre><code class="language-java">private static final Object PRESENT = new Object();

public HashSet() {
    map = new HashMap&lt;&gt;();
}

public boolean add(E e) {
    return map.put(e, PRESENT)==null;
}
</code></pre>
<h2><a id="concurrenthashmap" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ConcurrentHashMap</h2>
<p>HashMap çº¿ç¨‹ä¸å®‰å…¨, è§£å†³æ–¹æ¡ˆ:</p>
<ul>
<li>ä½¿ç”¨ <code>Collections.synchronizedMap(Map)</code></li>
<li>JUC è§£å†³æ–¹æ¡ˆ: ä½¿ç”¨ <code>ConcurrentHashMap</code>: å®ƒæœ‰å¤šä¸ªæ®µï¼Œæ¯ä¸ªæ®µä¸‹é¢éƒ½æ˜¯ä¸€ä¸ª<code>Hashtable</code>ï¼ˆç›¸ä¼¼ï¼‰ï¼Œæ‰€ä»¥æ¯ä¸ªæ®µä¸Šéƒ½æœ‰ä¸€æŠŠé”ï¼Œå„ä¸ªæ®µä¹‹é—´çš„é”äº’ä¸å½±å“ï¼Œå¯ä»¥å®ç°å¹¶å‘æ“ä½œã€‚</li>
</ul>
<p><img src="media/16226261701341/16226420497103.jpg" alt="" /></p>
<p>Jdk 1.8 ä¸­ï¼Œ ConcurrentHashMap å–æ¶ˆäº† segment åˆ†æ®µé”ï¼Œè€Œé‡‡ç”¨ CAS å’Œ synchronized æ¥ä¿è¯å¹¶å‘å®‰å…¨ã€‚æ•°æ®ç»“æ„è·Ÿ HashMap1.8 çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„ + é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚synchronized åªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹ï¼Œè¿™æ ·åªè¦ hash ä¸å†²çªï¼Œå°±ä¸ä¼šäº§ç”Ÿå¹¶å‘ï¼Œæ•ˆç‡åˆæå‡Nå€ã€‚</p>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16226256624681.html">é”ğŸ”’</a></h1>
			<p class="meta"><time datetime="2021-06-02T17:21:02+08:00" 
			pubdate data-updated="true">2021/06/02</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#%E5%85%AC%E5%B9%B3%E9%94%81%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81">å…¬å¹³é” &amp; éå…¬å¹³é”</a></li>
<li><a href="#%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81">ä¹è§‚é” &amp; æ‚²è§‚é”</a></li>
<li><a href="#%E8%87%AA%E6%97%8B%E9%94%81%EF%BC%88spin-lock%EF%BC%89">è‡ªæ—‹é”ï¼ˆspin lockï¼‰</a>
<ul>
<li><a href="#%E8%87%AA%E6%97%8B%E9%94%81%E6%98%AF%E4%B9%90%E8%A7%82%E9%94%81%E5%90%97%EF%BC%9F">è‡ªæ—‹é”æ˜¯ä¹è§‚é”å—ï¼Ÿ</a></li>
</ul>
</li>
<li><a href="#lock">Lock</a>
<ul>
<li><a href="#reentrantlock%EF%BC%88%E9%87%8D%E5%85%A5%E9%94%81%EF%BC%89">ReentrantLockï¼ˆé‡å…¥é”ï¼‰</a></li>
<li><a href="#readwritelock%EF%BC%88%E8%AF%BB%E5%86%99%E9%94%81%E3%80%81%E7%8B%AC%E5%8D%A0%E9%94%81%E3%80%81%E5%85%B1%E4%BA%AB%E9%94%81%EF%BC%89">ReadWriteLockï¼ˆè¯»å†™é”ã€ç‹¬å é”ã€å…±äº«é”ï¼‰</a></li>
</ul>
</li>
<li><a href="#synchronized">synchronized</a>
<ul>
<li><a href="#%E6%97%A0%E9%94%81%E5%81%8F%E5%90%91%E9%94%81%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81">æ— é” -&gt; åå‘é” -&gt; è½»é‡çº§é” -&gt; é‡é‡çº§é”</a></li>
<li><a href="#synchronized%E9%94%81%E5%8D%87%E7%BA%A7">synchronized é”å‡çº§</a></li>
<li><a href="#%E5%92%8Clock%E7%9A%84%E5%8C%BA%E5%88%AB">å’Œ Lock çš„åŒºåˆ«</a></li>
</ul>
</li>
<li><a href="#%E6%AD%BB%E9%94%81">æ­»é”</a></li>
</ul>
</div>
<p><strong>Blog: <a href="https://tech.meituan.com/2018/11/15/java-lock.html">ä¸å¯ä¸è¯´çš„Javaâ€œé”â€äº‹</a></strong></p>
<h2><a id="%E5%85%AC%E5%B9%B3%E9%94%81%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å…¬å¹³é” &amp; éå…¬å¹³é”</h2>
<ul>
<li>å…¬å¹³é”ï¼šå…¬å¹³ï¼Œä¸å¯ä»¥æ’é˜Ÿ</li>
<li><strong>éå…¬å¹³é”</strong>ï¼šä¸å…¬å¹³ï¼Œå¯ä»¥æ’é˜Ÿï¼ŒJava é»˜è®¤</li>
</ul>
<h2><a id="%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¹è§‚é” &amp; æ‚²è§‚é”</h2>
<ul>
<li>
<p>ä¹è§‚é”</p>
<p>ä¹è§‚é”æ˜¯ä¸€ç§ä¹è§‚æ€æƒ³ï¼Œå³è®¤ä¸ºè¯»å¤šå†™å°‘ï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§ä½ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œé‡‡å–åœ¨å†™æ—¶å…ˆè¯»å‡ºå½“å‰ç‰ˆæœ¬å·ï¼Œç„¶ååŠ é”æ“ä½œï¼ˆæ¯”è¾ƒè·Ÿä¸Šä¸€æ¬¡çš„ç‰ˆæœ¬å·ï¼Œå¦‚æœä¸€æ ·åˆ™æ›´æ–°ï¼‰ï¼Œå¦‚æœå¤±è´¥åˆ™è¦é‡å¤è¯»-æ¯”è¾ƒ-å†™çš„æ“ä½œã€‚ä¹è§‚é”ä¹Ÿæ˜¯é€šè¿‡ CAS æ“ä½œå®ç°çš„ã€‚</p>
</li>
<li>
<p>æ‚²è§‚é”</p>
<p>æ‚²è§‚é”æ˜¯å°±æ˜¯æ‚²è§‚æ€æƒ³ï¼Œå³è®¤ä¸ºå†™å¤šï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§é«˜ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨è¯»å†™æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³è¯»å†™è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°æ‹¿åˆ°é”ã€‚java ä¸­çš„æ‚²è§‚é”å°±æ˜¯ Synchronized, <strong>AQS æ¡†æ¶ä¸‹çš„é”åˆ™æ˜¯å…ˆå°è¯• cas ä¹è§‚é”å»è·å–é”ï¼Œè·å–ä¸åˆ°ï¼Œæ‰ä¼šè½¬æ¢ä¸ºæ‚²è§‚é”ï¼Œå¦‚ RetreenLock</strong>ã€‚</p>
</li>
</ul>
<h2><a id="%E8%87%AA%E6%97%8B%E9%94%81%EF%BC%88spin-lock%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>è‡ªæ—‹é”ï¼ˆspin lockï¼‰</h2>
<p>å¦‚æœè·å–ä¸åˆ°é”ï¼Œå®ƒä»¬åªéœ€è¦ç­‰ä¸€ç­‰ï¼ˆè‡ªæ—‹ï¼‰ï¼Œç­‰é”è¢«é‡Šæ”¾åå³å¯ç«‹å³è·å–é”ï¼Œè¿™æ ·å°±é¿å…ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çš„åˆ‡æ¢çš„æ¶ˆè€—ï¼Œä½¿ç”¨ CAS å®ç°ã€‚</p>
<pre><code class="language-java">class SpinLock {
    private AtomicReference&lt;Thread&gt; atomicReference = new AtomicReference&lt;&gt;();

    public void lock() {
        Thread thread = Thread.currentThread();
        while(!atomicReference.compareAndSet(null, thread)); // æ²¡æœ‰è¢«é”ä½çš„æ—¶å€™ï¼Œåº”è¯¥æ˜¯ null
    }
    public void unlock() {
        Thread thread = Thread.currentThread();
        atomicReference.compareAndSet(thread, null); // å¦‚æœæ˜¯å½“å‰çº¿ç¨‹è·å¾—é”ï¼Œè®¾ç½®æˆ null
    }
}
</code></pre>
<h3><a id="%E8%87%AA%E6%97%8B%E9%94%81%E6%98%AF%E4%B9%90%E8%A7%82%E9%94%81%E5%90%97%EF%BC%9F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>è‡ªæ—‹é”æ˜¯ä¹è§‚é”å—ï¼Ÿ</h3>
<p><strong>ä¸æ˜¯ã€‚ä¹è§‚é”å…¶å®æ˜¯æ— é”ï¼Œè‡ªæ—‹é”åªæ˜¯åœ¨å®ç°çš„æ—¶å€™åˆ©ç”¨äº†ä¹è§‚é”æ¥å®ç°ã€‚åº”è¯¥ç«™åœ¨åº”ç”¨å±‚åˆ†æï¼Œçœ‹å®ƒä»¬æ˜¯å¦‚ä½•é”ä½åº”ç”¨æ•°æ®çš„ï¼Œè€Œä¸æ˜¯ç«™åœ¨åº•å±‚çœ‹æŠ¢å é”çš„è¿‡ç¨‹ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–é”æ—¶ï¼Œå‘ç°å·²ç»è¢«å ç”¨ï¼Œå®ƒæ˜¯å¦ç»§ç»­è¯»å–æ•°æ®ï¼Œè¿˜æ˜¯ç­‰åç»­è¦æ›´æ–°æ—¶å†å†³å®šè¦ä¸è¦é‡è¯•ã€‚å…¶å®è‡ªæ—‹é”å¯¹åº”ç”¨æ•°æ®çš„è¯»å–æ“ä½œéƒ½è¢«æŒ¡ä½äº†ã€‚</strong></p>
<h2><a id="lock" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lock</h2>
<p><code>java.util.concurrent.locks</code> ä¸‰ä¸ªå®ç°ç±»: <code>ReentrantLock</code>, <code>ReentrantReadWriteLock.ReadLock</code>, <code>ReentrantReadWriteLock.WriteLock</code></p>
<ul>
<li>å¦‚ä½•ä½¿ç”¨</li>
</ul>
<pre><code class="language-java">lock.lock(); // åŠ é”
try {
    // ä¸šåŠ¡ä»£ç 
} catch (Exception e) {
    e.printStackTrace();
} finally {
    lock.unlock(); // è§£é”
}
</code></pre>
<h3><a id="reentrantlock%EF%BC%88%E9%87%8D%E5%85%A5%E9%94%81%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ReentrantLockï¼ˆé‡å…¥é”ï¼‰</h3>
<p>é‡å…¥é”ã€é€’å½’é”ï¼ŒJava å†…ç½®çš„é”ï¼ˆsynchronizedã€Lockï¼‰éƒ½æ˜¯é‡å…¥é”ã€‚<br />
é”çš„æ“ä½œç²’åº¦æ˜¯çº¿ç¨‹,è€Œä¸æ˜¯è°ƒç”¨ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹å†æ¬¡è¿›å…¥åŒæ­¥ä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå·±å·²ç»è·å–åˆ°çš„é”ã€‚</p>
<h3><a id="readwritelock%EF%BC%88%E8%AF%BB%E5%86%99%E9%94%81%E3%80%81%E7%8B%AC%E5%8D%A0%E9%94%81%E3%80%81%E5%85%B1%E4%BA%AB%E9%94%81%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ReadWriteLockï¼ˆè¯»å†™é”ã€ç‹¬å é”ã€å…±äº«é”ï¼‰</h3>
<p>è¯»å†™é”ï¼Œæ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶ã€‚ä¸€å¯¹å…³è”çš„é”ï¼Œä¸€ä¸ªç”¨äºåªè¯»ï¼Œä¸€ä¸ªç”¨äºå†™å…¥ã€‚è¯»é”å¯ä»¥å…±äº«ï¼Œå†™é”åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å¾—ã€‚(å¯ä»¥åŒæ—¶è¯»ï¼Œä¸å¯ä»¥åŒæ—¶å†™ï¼Œä¹Ÿä¸å¯ä»¥åŒæ—¶è¯»å†™)<br />
è¯­ä¹‰ä¸ <code>ReentrantLock</code> ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é‡å…¥é”ï¼Œå”¯ä¸€å®ç°ç±»æ˜¯ <code>ReentrantReadWriteLock</code></p>
<pre><code class="language-java">ReadWriteLock rwLock = new ReentrantReadWriteLock();
rwLock.writeLock(); // è·å¾—å†™é”ï¼ˆç‹¬å é”ï¼‰
rwLock.readLock(); // è·å¾—è¯»é”ï¼ˆå…±äº«é”ï¼‰
</code></pre>
<h2><a id="synchronized" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>synchronized</h2>
<p>JDK 6 ä¼˜åŒ–äº† synchronizedï¼Œå°†ä¹‹å‰çš„é‡é‡çº§é”æ”¹ä¸ºé”å‡çº§æœºåˆ¶</p>
<h3><a id="%E6%97%A0%E9%94%81%E5%81%8F%E5%90%91%E9%94%81%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ— é” -&gt; åå‘é” -&gt; è½»é‡çº§é” -&gt; é‡é‡çº§é”</h3>
<p><strong>æ— é”</strong>ï¼šæ— é”æ²¡æœ‰å¯¹èµ„æºè¿›è¡Œé”å®šï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½èƒ½è®¿é—®å¹¶ä¿®æ”¹åŒä¸€ä¸ªèµ„æºï¼Œä½†åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ä¿®æ”¹æˆåŠŸï¼Œä¾‹å¦‚ä¹è§‚é”ã€‚<br />
<strong>åå‘é”</strong>ï¼šï¼ˆå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥ä»£ç å—å¹¶è·å–é”æ—¶ï¼Œä¼šè®°ä½è¿™ä¸ªçº¿ç¨‹ IDã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è·å–é”çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥è·å–èµ„æºã€‚åªéœ€æ¯”è¾ƒ ThreadIDï¼‰<br />
<strong>è½»é‡çº§é”</strong>ï¼šæ˜¯æŒ‡å½“é”æ˜¯åå‘é”çš„æ—¶å€™ï¼Œè¢«å¦å¤–çš„çº¿ç¨‹æ‰€è®¿é—®ï¼Œåå‘é”å°±ä¼šå‡çº§ä¸ºè½»é‡çº§é”ï¼Œå…¶ä»–çº¿ç¨‹ä¼šé€šè¿‡è‡ªæ—‹çš„å½¢å¼å°è¯•è·å–é”ï¼ˆè‡ªæ—‹é”ï¼‰ï¼Œä¸ä¼šé˜»å¡ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚ï¼ˆè‡ªæ—‹ï¼‰<br />
<strong>é‡é‡çº§é”</strong>ï¼šç­‰å¾…é”çš„çº¿ç¨‹éƒ½ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚å½“è½»é‡çº§é”è‡ªæ—‹è¶…è¿‡ä¸€å®šçš„æ¬¡æ•°ï¼Œæˆ–è€…ä¸€ä¸ªçº¿ç¨‹åœ¨æŒæœ‰é”ï¼Œä¸€ä¸ªåœ¨è‡ªæ—‹ï¼Œåˆæœ‰ç¬¬ä¸‰ä¸ªæ¥è®¿æ—¶ï¼Œè½»é‡çº§é”å‡çº§ä¸ºé‡é‡çº§é”ã€‚ï¼ˆä¾èµ–OSçš„äº’æ–¥é” mutex lockï¼‰</p>
<h3><a id="synchronized%E9%94%81%E5%8D%87%E7%BA%A7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>synchronized é”å‡çº§</h3>
<p>åˆæ¬¡æ‰§è¡Œåˆ° synchronized ä»£ç å—çš„æ—¶å€™ï¼Œé”å¯¹è±¡å˜æˆåå‘é”ï¼Œæ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—åï¼Œçº¿ç¨‹å¹¶ä¸ä¼šä¸»åŠ¨é‡Šæ”¾åå‘é”ã€‚</p>
<p>å½“ç¬¬äºŒæ¬¡åˆ°è¾¾åŒæ­¥ä»£ç å—æ—¶ï¼Œçº¿ç¨‹ä¼šåˆ¤æ–­æ­¤æ—¶æŒæœ‰é”çš„çº¿ç¨‹IDæ˜¯å¦å°±æ˜¯è‡ªå·±ï¼Œå¦‚æœæ˜¯åˆ™ç›´æ¥å¾€ä¸‹æ‰§è¡Œï¼Œæ€§èƒ½æé«˜ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸€æ—¦æœ‰ç¬¬äºŒä¸ªçº¿ç¨‹åŠ å…¥é”ç«äº‰ï¼Œåå‘é”å°±å‡çº§ä¸ºè½»é‡çº§é”ï¼ˆè‡ªæ—‹é”ï¼‰ï¼Œæ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹å°†è‡ªæ—‹ã€‚æŠ¢åˆ°é”åçº¿ç¨‹å°†å½“å‰é”çš„æŒæœ‰è€…ä¿¡æ¯ä¿®æ”¹ä¸ºè‡ªå·±ã€‚</p>
<p>å¦‚æœé”ç«äº‰æƒ…å†µä¸¥é‡ï¼ŒæŸä¸ªè¾¾åˆ°æœ€å¤§è‡ªæ—‹æ¬¡æ•°çš„çº¿ç¨‹ï¼Œä¼šå°†è½»é‡çº§é”å‡çº§ä¸ºé‡é‡çº§é”ï¼Œå½“åç»­çº¿ç¨‹å°è¯•è·å–é”æ—¶ï¼Œåˆ™ç›´æ¥å°†è‡ªå·±æŒ‚èµ·ï¼ˆè€Œä¸æ˜¯å¿™ç­‰ï¼‰ï¼Œç­‰å¾…å°†æ¥è¢«å”¤é†’ã€‚</p>
<p>âš ï¸ï¼š<strong>å½“ç¬¬äºŒä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°è¿™ä¸ª synchronized ä»£ç å—æ—¶æ˜¯å¦ä¸€å®šä¼šå‘ç”Ÿé”ç«äº‰ç„¶åå‡çº§ä¸ºè½»é‡çº§é”å‘¢ï¼Ÿ</strong></p>
<p>çº¿ç¨‹Aç¬¬ä¸€æ¬¡æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—åï¼Œå½“çº¿ç¨‹Bå°è¯•è·å–é”çš„æ—¶å€™ï¼Œå‘ç°æ˜¯åå‘é”ï¼Œä¼šåˆ¤æ–­çº¿ç¨‹Aæ˜¯å¦ä»ç„¶å­˜æ´»ã€‚å¦‚æœçº¿ç¨‹Aä»ç„¶å­˜æ´»ï¼Œå°†çº¿ç¨‹Aæš‚åœï¼Œæ­¤æ—¶åå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼Œä¹‹åçº¿ç¨‹Aç»§ç»­æ‰§è¡Œï¼Œçº¿ç¨‹Bè‡ªæ—‹ã€‚ä½†æ˜¯å¦‚æœåˆ¤æ–­ç»“æœæ˜¯çº¿ç¨‹Aä¸å­˜åœ¨äº†ï¼Œåˆ™çº¿ç¨‹BæŒæœ‰æ­¤åå‘é”ï¼Œé”ä¸å‡çº§ã€‚</p>
<h3><a id="%E5%92%8Clock%E7%9A%84%E5%8C%BA%E5%88%AB" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å’Œ Lock çš„åŒºåˆ«</h3>
<p><code>synchronized</code> æ— æ³•åˆ¤æ–­é”çš„çŠ¶æ€<br />
<code>synchronized</code> ä¼šè‡ªåŠ¨é‡Šæ”¾é”; Lock å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾<br />
<code>synchronized</code> è·å–ä¸åˆ°é”ä¼šé˜»å¡; Lock å¯ä»¥ä½¿ç”¨ <code>tryLock()</code> å°è¯•è·å–ä¸åˆ°ä¸ä¼šä¸€ç›´ç­‰å¾…<br />
<code>synchronized</code> é€‚åˆé”å°‘é‡ä»£ç åŒæ­¥; Lock é€‚åˆå¤§é‡åŒæ­¥ä»£ç <br />
<code>synchronized</code> ä¼šé”å‡çº§ï¼Œä½†æ˜¯æ˜¯ä¸å¯é€†çš„ï¼Œä¸€æ—¦å‡çº§ä¸ºé‡é‡çº§é”ï¼Œå°±å›ä¸å»äº†ï¼Œå¦‚æœå¹¶å‘é‡ä¸ç¨³å®šï¼Œå¯èƒ½é€ æˆæ€§èƒ½æŸå¤±<br />
<code>synchronized</code> ç”± JVM å®ç°ï¼Œåº•å±‚é”ä½çš„æ˜¯å¯¹è±¡å¤´ï¼Œ<code>Lock</code> ç”± JDK å®ç°ï¼Œä¾èµ– AQSï¼Œé€šè¿‡ state åˆ¤æ–­</p>
<p>synchronized é”çš„æ˜¯æ–¹æ³•çš„è°ƒç”¨è€… (<code>this</code>), é™æ€æ–¹æ³•é”çš„æ˜¯ Class å¯¹è±¡, æ‰€æœ‰çš„å®ä¾‹å…±äº«ä¸€æŠŠé”</p>
<p>åˆ†åˆ«ä½¿ç”¨ <code>synchronized</code> å’Œ <code>Lock</code> å®ç° <a href="16227416766193.html">ç”Ÿäº§è€…æ¶ˆè´¹è€…</a><br />
ä½¿ç”¨ Condition æœ‰ä»€ä¹ˆå¥½å¤„: å¯ä»¥ä½¿ç”¨å¤šä¸ª Condition è¾¾åˆ°ç²¾å‡†é€šçŸ¥æŸä¸ªçº¿ç¨‹çš„ç›®çš„</p>
<pre><code class="language-java">class ConditionTest {
    private Lock lock = new ReentrantLock();
    private Condition condition1 = lock.newCondition();
    private Condition condition2 = lock.newCondition();
    private int num = 1; // é»˜è®¤ç¬¬ä¸€ä¸ªå…ˆæ‰§è¡Œ
    
    public void show1() {
        lock.lock();
        try {
            while (num != 1) condition1.await(); // 1ç­‰å¾…
            System.out.println(Thread.currentThread().getName());
            num = 2;
            condition2.signal(); // æ‰§è¡Œå®Œé€šçŸ¥2
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            lock.unlock();
        }
    }
    
    public void show2() {
        lock.lock();
        try {
            while (num != 2) condition2.await(); // 2ç­‰å¾…
            System.out.println(Thread.currentThread().getName());
            num = 1;
            condition1.signal(); // æ‰§è¡Œå®Œé€šçŸ¥1
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            lock.unlock();
        }
    }
}
</code></pre>
<pre><code class="language-java">// è°ƒç”¨
ConditionTest conditionTest = new ConditionTest();
new Thread(() -&gt; { for (int i = 0; i &lt; 10; i++) conditionTest.show1(); }, &quot;A&quot;).start();
    
new Thread(() -&gt; { for (int i = 0; i &lt; 10; i++) conditionTest.show2(); }, &quot;B&quot;).start();
// ç»“æœ: A B A B A B A B .....
</code></pre>
<h2><a id="%E6%AD%BB%E9%94%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ­»é”</h2>
<p>å°è¯•è·å–å¯¹æ–¹çš„é”ï¼Œå¦‚ä½•æ’æŸ¥ï¼Ÿ</p>
<ol>
<li>æŸ¥çœ‹æ—¥å¿—</li>
<li><strong>æŸ¥çœ‹å †æ ˆä¿¡æ¯</strong>ï¼ˆä½¿ç”¨ <code>jps -l</code> æŸ¥çœ‹ java è¿›ç¨‹å·ã€ä½¿ç”¨ <code>jstack è¿›ç¨‹å·</code> æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯ï¼‰</li>
</ol>


		</div>

		

	</article>
 
	<article>
		 <header>
		  	<h1 class="entry-title"><a href="16226153690757.html">çº¿ç¨‹è¿›ç¨‹</a></h1>
			<p class="meta"><time datetime="2021-06-02T14:29:29+08:00" 
			pubdate data-updated="true">2021/06/02</time></p>
		 </header>
	  	<div class="entry-content">
		  	
		  	<div class="mweb_toc"><ul>
<li><a href="#%E6%A6%82%E5%BF%B5">æ¦‚å¿µ</a></li>
<li><a href="#%E7%BA%BF%E7%A8%8B%E5%92%8C%E8%BF%9B%E7%A8%8B">çº¿ç¨‹å’Œè¿›ç¨‹</a>
<ul>
<li><a href="#%E5%B9%B6%E5%8F%91%E5%92%8C%E5%B9%B6%E8%A1%8C">å¹¶å‘å’Œå¹¶è¡Œ</a></li>
<li><a href="#%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81">çº¿ç¨‹çŠ¶æ€</a></li>
<li><a href="#wait-sleep">wait &amp; sleep</a></li>
</ul>
</li>
</ul>
</div>
<h2><a id="%E6%A6%82%E5%BF%B5" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ¦‚å¿µ</h2>
<p>Jdk ä¸‰ä¸ªåŒ…: <code>java.util.concurrent</code> åŒ…ä»¥åŠè¿™ä¸ªåŒ…ä¸‹é¢çš„ atomic å’Œ lock åŒ…é‡Œçš„å·¥å…·</p>
<h2><a id="%E7%BA%BF%E7%A8%8B%E5%92%8C%E8%BF%9B%E7%A8%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>çº¿ç¨‹å’Œè¿›ç¨‹</h2>
<p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹, è‡³å°‘åŒ…å«ä¸€ä¸ª<br />
å¯¹äº Java è€Œè¨€, é»˜è®¤æœ‰ 2 ä¸ªçº¿ç¨‹: main å’Œ GC, å¼€å¯çº¿ç¨‹çš„æ–¹å¼: <code>Thread</code> <code>Callable</code> <code>Runnable</code>, ä½†æœ€ç»ˆæ—¶é€šè¿‡æœ¬åœ°æ–¹æ³•è°ƒç”¨æœ¬åœ° C++ æ–¹æ³•.</p>
<p>åŒºåˆ«:</p>
<ul>
<li>èµ„æº: è¿›ç¨‹æ—¶èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½, çº¿ç¨‹ä¸æ‹¥æœ‰èµ„æº</li>
<li>è°ƒåº¦: çº¿ç¨‹æ˜¯ç‹¬ç«‹è°ƒåº¦çš„åŸºæœ¬å•ä½</li>
<li>å¼€é”€: åˆ›å»ºé”€æ¯è¿›ç¨‹æ—¶, ä¼šåˆ†é…å›æ”¶èµ„æº; çº¿ç¨‹åªéœ€è¦è®¾ç½®å°‘é‡å¯„å­˜å™¨, å¼€é”€å°</li>
<li>é€šä¿¡: çº¿ç¨‹é—´é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œæ•°æ®é€šä¿¡, è¿›ç¨‹ä¸€èˆ¬éœ€è¦å€ŸåŠ© IPC</li>
</ul>
<h3><a id="%E5%B9%B6%E5%8F%91%E5%92%8C%E5%B9%B6%E8%A1%8C" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å¹¶å‘å’Œå¹¶è¡Œ</h3>
<p>å¹¶å‘: å®è§‚ä¸Šåœ¨åŒä¸€æ®µæ—¶é—´åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åº, å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æº<br />
å¹¶è¡Œ: åŒä¸€æ—¶åˆ»èƒ½å¤Ÿè¿è¡Œå¤šä¸ªæŒ‡ä»¤, éœ€è¦ç¡¬ä»¶æ”¯æŒ</p>
<h3><a id="%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>çº¿ç¨‹çŠ¶æ€</h3>
<p><img src="media/16226153690757/16226167728821.jpg" alt="" class="mw_img_center" style="width:602px;display: block; clear:both; margin: 0 auto;" /></p>
<h3><a id="wait-sleep" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>wait &amp; sleep</h3>
<p>æ¥è‡ªä¸åŒçš„ç±»: wait æ¥è‡ª Object; sleep æ¥è‡ª Thread<br />
é”çš„é‡Šæ”¾: wait ä¼šé‡Šæ”¾é”; sleep ä¸ä¼šé‡Šæ”¾<br />
ä½¿ç”¨èŒƒå›´ä¸åŒ: wait å¿…é¡»åœ¨åŒæ­¥ä»£ç å—ä¸­ä½¿ç”¨; sleep å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨</p>


		</div>

		

	</article>
  
	<div class="pagination">
	
<a href="archives.html">Blog Archives</a>
	 
	    
	</div>
</div>
 <aside class="sidebar"> 

	<section>
	  <h1>Categories</h1>
	  <ul id="recent_posts">
	  
	      <li class="post">
	        <a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html"><strong>æ•°æ®åº“&nbsp;(1)</strong></a>
	        
	        
	        
	      </li>
	  
	      <li class="post">
	        <a href="Redis.html"><strong>Redis&nbsp;(7)</strong></a>
	        
	        
	        
	      </li>
	  
	      <li class="post">
	        <a href="%E5%88%86%E5%B8%83%E5%BC%8F.html"><strong>åˆ†å¸ƒå¼&nbsp;(3)</strong></a>
	        
	        
	        
	      </li>
	  
	      <li class="post">
	        <a href="%E6%A1%86%E6%9E%B6.html"><strong>æ¡†æ¶&nbsp;(15)</strong></a>
	         <p class="cat-children-p"> 
	        
	        	<a href="Netty.html">Netty&nbsp;(10)</a>&nbsp;&nbsp;
	        
	        	<a href="WebService.html">WebService&nbsp;(5)</a>&nbsp;&nbsp;
	        
	         </p> 
	      </li>
	  
	      <li class="post">
	        <a href="%E6%A0%A1%E6%8B%9B.html"><strong>æ ¡æ‹›&nbsp;(2)</strong></a>
	        
	        
	        
	      </li>
	  
	      <li class="post">
	        <a href="Algorithm.html"><strong>Algorithm&nbsp;(13)</strong></a>
	        
	        
	        
	      </li>
	  
	      <li class="post">
	        <a href="Java.html"><strong>Java&nbsp;(35)</strong></a>
	         <p class="cat-children-p"> 
	        
	        	<a href="JVM.html">JVM&nbsp;(5)</a>&nbsp;&nbsp;
	        
	        	<a href="JUC.html">JUC&nbsp;(13)</a>&nbsp;&nbsp;
	        
	        	<a href="JavaSe.html">JavaSe&nbsp;(17)</a>&nbsp;&nbsp;
	        
	         </p> 
	      </li>
	  
	      <li class="post">
	        <a href="%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html"><strong>æ“ä½œç³»ç»Ÿ&nbsp;(2)</strong></a>
	        
	        
	        
	      </li>
	  
	      <li class="post">
	        <a href="%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html"><strong>è®¡ç®—æœºç½‘ç»œ&nbsp;(4)</strong></a>
	        
	        
	        
	      </li>
	   
	  </ul>
	</section>
	<section>
	  <h1>Recent Posts</h1>
	  <ul id="recent_posts">
	  
	      
		      <li class="post">
		        <a href="16242598828200.html">æ•°æ®åº“</a>
		      </li>
	     
	  
	      
		      <li class="post">
		        <a href="16261749989563.html">ä¸»ä» & å“¨å…µ</a>
		      </li>
	     
	  
	      
		      <li class="post">
		        <a href="16261740670297.html">æ·˜æ±°ç­–ç•¥</a>
		      </li>
	     
	  
	      
		      <li class="post">
		        <a href="16261737897880.html">ä¸ MemCached å¯¹æ¯”</a>
		      </li>
	     
	  
	      
		      <li class="post">
		        <a href="16261704935337.html">Redis æ•°æ®ç»“æ„</a>
		      </li>
	     
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	  
	      
	   
	  </ul>
	</section>
	
</aside> </div></div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 -  -
  <span class="credit">Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a> &nbsp;&nbsp; Theme by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>



  














<style type="text/css">
  
/* PrismJS 1.14.0
https://prismjs.com/download.html#themes=prism-solarizedlight&languages=markup+css+clike+javascript */
/*
 Solarized Color Schemes originally by Ethan Schoonover
 http://ethanschoonover.com/solarized

 Ported for PrismJS by Hector Matos
 Website: https://krakendev.io
 Twitter Handle: https://twitter.com/allonsykraken)
*/

/*
SOLARIZED HEX
--------- -------
base03    #002b36
base02    #073642
base01    #586e75
base00    #657b83
base0     #839496
base1     #93a1a1
base2     #eee8d5
base3     #fdf6e3
yellow    #b58900
orange    #cb4b16
red       #dc322f
magenta   #d33682
violet    #6c71c4
blue      #268bd2
cyan      #2aa198
green     #859900
*/

code[class*="language-"],
pre[class*="language-"] {
  color: #657b83; /* base00 */
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;

  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
  background: #073642; /* base02 */
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
  background: #073642; /* base02 */
}

/* Code blocks */
pre[class*="language-"] {
  padding: 1em;
  margin: .5em 0;
  overflow: auto;
  border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
  background-color: #fdf6e3; /* base3 */
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #93a1a1; /* base1 */
}

.token.punctuation {
  color: #586e75; /* base01 */
}

.namespace {
  opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
  color: #268bd2; /* blue */
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.url,
.token.inserted {
  color: #2aa198; /* cyan */
}

.token.entity {
  color: #657b83; /* base00 */
  background: #eee8d5; /* base2 */
}

.token.atrule,
.token.attr-value,
.token.keyword {
  color: #859900; /* green */
}

.token.function,
.token.class-name {
  color: #b58900; /* yellow */
}

.token.regex,
.token.important,
.token.variable {
  color: #cb4b16; /* orange */
}

.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}

.token.entity {
  cursor: help;
}


pre[class*="language-"].line-numbers {
    position: relative;
    padding-left: 3.8em;
    counter-reset: linenumber;
}

pre[class*="language-"].line-numbers > code {
    position: relative;
    white-space: inherit;
}

.line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 0;
    font-size: 100%;
    left: -3.8em;
    width: 3em; /* works for line-numbers below 1000 lines */
    letter-spacing: -1px;
    border-right: 1px solid #999;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

}

    .line-numbers-rows > span {
        pointer-events: none;
        display: block;
        counter-increment: linenumber;
    }

        .line-numbers-rows > span:before {
            content: counter(linenumber);
            color: #999;
            display: block;
            padding-right: 0.8em;
            text-align: right;
        }

</style>
  
    


</body>
</html>